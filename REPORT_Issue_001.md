# –û—Ç—á—ë—Ç –ø–æ Issue #1: –†–µ–∞–ª–∏–∑–∞—Ü–∏—è prepare_dataset.py

**–ê–≤—Ç–æ—Ä:** –ù–∏–∫–æ–ª–∞–π (Senior ML Engineer)  
**–î–∞—Ç–∞:** 2026-01-08  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ  
**Issue:** #1 (prepare_dataset.py)

---

## üéØ –¶–µ–ª—å –∑–∞–¥–∞—á–∏

–°–æ–∑–¥–∞—Ç—å –º–æ–¥—É–ª—å–Ω—ã–π, –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π —Å–∫—Ä–∏–ø—Ç `prepare_dataset.py` —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º **–û–û–ü-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã** –¥–ª—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –¥–∞—Ç–∞—Å–µ—Ç–∞ —Ä—É–∫–æ–ø–∏—Å–Ω—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤ –∫ fine-tuning DeepSeek-OCR.

---

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞

### 1. –°–æ–∑–¥–∞–Ω–∞ –º–æ–¥—É–ª—å–Ω–∞—è –û–û–ü-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã 4 –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö –∫–ª–∞—Å—Å–∞, –∫–∞–∂–¥—ã–π –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ —Å–≤–æ—é –∑–∞–¥–∞—á—É (Single Responsibility Principle):

#### `DatasetLoader` (`utils/data_loader.py`)
- –ó–∞–≥—Ä—É–∑–∫–∞ CSV-–∞–Ω–Ω–æ—Ç–∞—Ü–∏–π —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π —Ñ–æ—Ä–º–∞—Ç–∞
- –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏–∑ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –ø—É—Ç–µ–π
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —Å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- Type hints –¥–ª—è –≤—Å–µ—Ö –º–µ—Ç–æ–¥–æ–≤
- Docstrings –≤ —Å—Ç–∏–ª–µ Google
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–π logger
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (–ø—Ä–æ–ø—É—Å–∫ —Å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ–º)

#### `DataValidator` (`utils/data_validator.py`)
- –í–∞–ª–∏–¥–∞—Ü–∏—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π (filename, text, image, width, height)
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 100px)
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–ª–∏–Ω—ã —Ç–µ–∫—Å—Ç–∞ (–º–∞–∫—Å–∏–º—É–º 10000 —Å–∏–º–≤–æ–ª–æ–≤)
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –Ω–µ–≤–∞–ª–∏–¥–Ω—ã—Ö –æ–±—Ä–∞–∑—Ü–æ–≤

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏
- –î–µ—Ç–∞–ª—å–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ (–≤–∞–ª–∏–¥–Ω—ã–µ/–Ω–µ–≤–∞–ª–∏–¥–Ω—ã–µ)

#### `ImageProcessor` (`utils/image_processor.py`) ‚Äî —Ä–∞—Å—à–∏—Ä–µ–Ω
–†–∞—Å—à–∏—Ä–µ–Ω —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–ª–∞—Å—Å –º–µ—Ç–æ–¥–∞–º–∏ –¥–ª—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –¥–∞—Ç–∞—Å–µ—Ç–∞:

**–ù–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã:**
- `resize_keep_aspect_ratio()` ‚Äî –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –ø—Ä–æ–ø–æ—Ä—Ü–∏–π
- `save()` ‚Äî —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ JPEG —Å –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–º –∫–∞—á–µ—Å—Ç–≤–æ–º
- `process()` ‚Äî –ø–æ–ª–Ω—ã–π –ø–∞–π–ø–ª–∞–π–Ω –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∏ (RGB –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è + resize)

**–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:**
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –æ–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å–æ —Å—Ç–∞—Ä—ã–º API
- –î–æ–±–∞–≤–ª–µ–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä `max_size` –¥–ª—è –Ω–æ–≤–æ–≥–æ API
- –ü–∞—Ä–∞–º–µ—Ç—Ä `jpeg_quality` –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è –∫–∞—á–µ—Å—Ç–≤–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è

#### `DatasetSplitter` (`utils/dataset_splitter.py`)
- –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –¥–∞—Ç–∞—Å–µ—Ç–∞ –Ω–∞ train/val (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 80/20)
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ random seed –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç–∏
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ metadata.json –≤ —Ñ–æ—Ä–º–∞—Ç–µ, —É–∫–∞–∑–∞–Ω–Ω–æ–º –≤ Issue
- –ì–∞—Ä–∞–Ω—Ç–∏—è —Ö–æ—Ç—è –±—ã –æ–¥–Ω–æ–≥–æ –æ–±—Ä–∞–∑—Ü–∞ –≤ val

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º–æ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ train/val
- –§–æ—Ä–º–∞—Ç metadata.json —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ Issue
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π

### 2. –ì–ª–∞–≤–Ω—ã–π —Å–∫—Ä–∏–ø—Ç `prepare_dataset.py`

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –∫–ª–∞—Å—Å `DatasetPreparer`, –∫–æ—Ç–æ—Ä—ã–π –æ—Ä–∫–µ—Å—Ç—Ä–∏—Ä—É–µ—Ç –≤—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
1. –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞—Ç–∞—Å–µ—Ç–∞ (`DatasetLoader`)
2. –í–∞–ª–∏–¥–∞—Ü–∏—è (`DataValidator`)
3. –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ train/val (`DatasetSplitter`)
4. –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ train
5. –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ val

**CLI –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å:**
- `--raw-images` ‚Äî –ø—É—Ç—å –∫ —Å—ã—Ä—ã–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `data/raw`)
- `--annotations` ‚Äî –ø—É—Ç—å –∫ CSV (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `data/annotated/annotations.csv`)
- `--output` ‚Äî –ø—É—Ç—å –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `data/processed`)
- `--train-ratio` ‚Äî –¥–æ–ª—è train (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 0.8)
- `--max-size` ‚Äî –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 1024)
- `--seed` ‚Äî random seed (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 42)

**–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –ª–æ–≥–æ–≤ –≤ `logs/prepare_dataset_YYYYMMDD_HHMMSS.log`
- –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞–∂–¥–æ–≥–æ —à–∞–≥–∞
- –û—à–∏–±–∫–∏ —Å –ø–æ–ª–Ω—ã–º traceback

---

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
DSOCR-HW/
‚îú‚îÄ‚îÄ utils/
‚îÇ   ‚îú‚îÄ‚îÄ data_loader.py          ‚úÖ DatasetLoader (–Ω–æ–≤—ã–π)
‚îÇ   ‚îú‚îÄ‚îÄ data_validator.py       ‚úÖ DataValidator (–Ω–æ–≤—ã–π)
‚îÇ   ‚îú‚îÄ‚îÄ dataset_splitter.py     ‚úÖ DatasetSplitter (–Ω–æ–≤—ã–π)
‚îÇ   ‚îú‚îÄ‚îÄ image_processor.py      ‚úÖ ImageProcessor (—Ä–∞—Å—à–∏—Ä–µ–Ω)
‚îÇ   ‚îî‚îÄ‚îÄ logger.py               ‚úÖ (—É–∂–µ –±—ã–ª)
‚îÇ
‚îî‚îÄ‚îÄ scripts/
    ‚îî‚îÄ‚îÄ prepare_dataset.py      ‚úÖ DatasetPreparer + CLI (–Ω–æ–≤—ã–π)
```

---

## üß™ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –∫–æ–¥–∞

### –°–∏–Ω—Ç–∞–∫—Å–∏—Å
```bash
python -m py_compile scripts/prepare_dataset.py utils/data_loader.py utils/data_validator.py utils/dataset_splitter.py utils/image_processor.py
```
‚úÖ **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ë–µ–∑ –æ—à–∏–±–æ–∫

### –õ–∏–Ω—Ç–µ—Ä
‚úÖ **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –û—à–∏–±–æ–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ

### –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º

- ‚úÖ **Type hints:** –í—Å–µ –º–µ—Ç–æ–¥—ã –∏ —Ñ—É–Ω–∫—Ü–∏–∏ —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω—ã
- ‚úÖ **Docstrings:** Google style –¥–ª—è –≤—Å–µ—Ö –∫–ª–∞—Å—Å–æ–≤ –∏ –º–µ—Ç–æ–¥–æ–≤
- ‚úÖ **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:** try-except —Å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º traceback
- ‚úÖ **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:** –ß–µ—Ä–µ–∑ `utils/logger.py`
- ‚úÖ **–ú–æ–¥—É–ª—å–Ω–æ—Å—Ç—å:** –ö–∞–∂–¥—ã–π –∫–ª–∞—Å—Å –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º —Ñ–∞–π–ª–µ
- ‚úÖ **–û–û–ü:** –ò–Ω–∫–∞–ø—Å—É–ª—è—Ü–∏—è, Single Responsibility Principle

---

## üìù –§–æ—Ä–º–∞—Ç –≤—ã—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π
```
data/processed/
‚îú‚îÄ‚îÄ train/
‚îÇ   ‚îú‚îÄ‚îÄ images/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ 00001.jpg
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ 00002.jpg
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ   ‚îî‚îÄ‚îÄ metadata.json
‚îî‚îÄ‚îÄ val/
    ‚îú‚îÄ‚îÄ images/
    ‚îÇ   ‚îú‚îÄ‚îÄ 00001.jpg
    ‚îÇ   ‚îî‚îÄ‚îÄ ...
    ‚îî‚îÄ‚îÄ metadata.json
```

### –§–æ—Ä–º–∞—Ç metadata.json
```json
[
  {
    "image_id": "00001",
    "image_path": "images/00001.jpg",
    "text": "–¢–µ–∫—Å—Ç —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è\n–ú–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω—ã–π",
    "original_filename": "handwriting_001.jpg",
    "width": 1024,
    "height": 768,
    "split": "train"
  },
  ...
]
```

---

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ë–∞–∑–æ–≤—ã–π –ø—Ä–∏–º–µ—Ä
```powershell
python scripts/prepare_dataset.py \
  --raw-images data/raw \
  --annotations data/annotated/annotations.csv \
  --output data/processed
```

### –° –∫–∞—Å—Ç–æ–º–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
```powershell
python scripts/prepare_dataset.py \
  --raw-images data/raw \
  --annotations data/annotated/annotations.csv \
  --output data/processed \
  --train-ratio 0.85 \
  --max-size 2048 \
  --seed 123
```

### –ü—Ä–∏–º–µ—Ä –∑–∞–ø—É—Å–∫–∞ (–ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ)
```powershell
cd C:\DSOCR-HW
.\venv\Scripts\Activate.ps1
python scripts/prepare_dataset.py --raw-images data/raw --annotations data/annotated/annotations.csv --output data/processed
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –£—Å–ø–µ—à–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ 2 –æ–±—Ä–∞–∑—Ü–∞, —Å–æ–∑–¥–∞–Ω—ã train –∏ val —Å–ø–ª–∏—Ç—ã.

---

## ‚ö†Ô∏è –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

1. **Augmentation:** –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ (—É–∫–∞–∑–∞–Ω–æ –∫–∞–∫ –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ –¥–ª—è –±—É–¥—É—â–µ–≥–æ)
2. **–°—Ç—Ä–∞—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è:** –ü—Ä–æ—Å—Ç–æ–π random split (–±–µ–∑ —Å—Ç—Ä–∞—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø–æ –¥–ª–∏–Ω–µ —Ç–µ–∫—Å—Ç–∞)
3. **–§–æ—Ä–º–∞—Ç—ã:** –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ JPEG, PNG, TIFF (—á–µ—Ä–µ–∑ PIL)

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

**–¢–µ—Å—Ç–æ–≤—ã–π –¥–∞—Ç–∞—Å–µ—Ç:**
- 2 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è: `test_001.jpg`, `test_002.jpg`
- CSV —Ñ–∞–π–ª —Å –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º–∏ –∞–Ω–Ω–æ—Ç–∞—Ü–∏—è–º–∏
- –¢–µ–∫—Å—Ç—ã: "–û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞!" –∏ "–≠—Ç–æ –ª—É—á—à–∞—è –∫–æ–º–∞–Ω–¥–∞, —á—Ç–æ —è –≤—Å—Ç—Ä–µ—á–∞–ª."

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:**
```
‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ –æ–±—Ä–∞–∑—Ü–æ–≤: 2/2
‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è: 2 –≤–∞–ª–∏–¥–Ω—ã—Ö, 0 –Ω–µ–≤–∞–ª–∏–¥–Ω—ã—Ö
‚úÖ Split: Train=1, Val=1
‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ train: 1 –æ–±—Ä–∞–∑–µ—Ü —Å–æ—Ö—Ä–∞–Ω—ë–Ω
‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ val: 1 –æ–±—Ä–∞–∑–µ—Ü —Å–æ—Ö—Ä–∞–Ω—ë–Ω
```

**–°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:**
- `data/processed/train/images/00001.jpg` (1024x111, RGB)
- `data/processed/train/metadata.json` ‚úÖ
- `data/processed/val/images/00001.jpg` (856x160, RGB)
- `data/processed/val/metadata.json` ‚úÖ
- `logs/prepare_dataset_20260108_214537.log` ‚úÖ

**–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∞ metadata.json:**
- ‚úÖ –í—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç
- ‚úÖ –§–æ—Ä–º–∞—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ Issue
- ‚úÖ –¢–µ–∫—Å—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ (UTF-8)
- ‚úÖ –†–∞–∑–º–µ—Ä—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∑–∞–ø–∏—Å–∞–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- ‚úÖ Split —É–∫–∞–∑–∞–Ω –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

**–í—ã–≤–æ–¥:** –°–∫—Ä–∏–ø—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ, –≤—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É—é—Ç –∫–∞–∫ –∑–∞–¥—É–º–∞–Ω–æ. –ì–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.

---

## üìã –ß–µ–∫–ª–∏—Å—Ç –∏–∑ Issue

- [x] –í—Å–µ –∫–ª–∞—Å—Å—ã —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –≤ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –º–æ–¥—É–ª—è—Ö (`utils/*.py`)
- [x] –í—Å–µ –º–µ—Ç–æ–¥—ã –∏–º–µ—é—Ç type hints
- [x] –í—Å–µ –∫–ª–∞—Å—Å—ã –∏ –º–µ—Ç–æ–¥—ã –∏–º–µ—é—Ç docstrings (Google style)
- [x] –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ —á–µ—Ä–µ–∑ `utils/logger.py`
- [x] –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ (try-except) –¥–ª—è –≤—Å–µ—Ö –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- [x] –ö–æ–¥ –ø—Ä–æ–≤–µ—Ä–µ–Ω –Ω–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å: `python -m py_compile`
- [x] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–º –¥–∞—Ç–∞—Å–µ—Ç–µ (2 –æ–±—Ä–∞–∑—Ü–∞) ‚Äî **‚úÖ –ü–†–û–¢–ï–°–¢–ò–†–û–í–ê–ù–û**
- [x] –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `data/processed/train/` –∏ `data/processed/val/`
- [x] –õ–æ–≥–∏ —Å–æ–∑–¥–∞–Ω—ã –≤ `logs/prepare_dataset_*.log`
- [x] Git –∫–æ–º–º–∏—Ç –≥–æ—Ç–æ–≤

---

## üí° –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ä–µ—à–µ–Ω–∏—è

1. **–û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:** `ImageProcessor` —Ä–∞—Å—à–∏—Ä–µ–Ω –±–µ–∑ breaking changes
2. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:** –ï–¥–∏–Ω—ã–π –ø–æ–¥—Ö–æ–¥ —á–µ—Ä–µ–∑ dependency injection (logger –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –≤ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä—ã)
3. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:** –ö–∞–∂–¥—ã–π –∫–ª–∞—Å—Å –ª–æ–≥–∏—Ä—É–µ—Ç —Å–≤–æ–∏ –æ—à–∏–±–∫–∏, –Ω–æ –Ω–µ –ø–æ–¥–∞–≤–ª—è–µ—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏—è
4. **–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ:** –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ processed_width/height –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π —Ä–∞–∑–º–µ—Ä–∞

---

## üìû –ß—Ç–æ –¥–∞–ª—å—à–µ?

1. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:** –ù—É–∂–µ–Ω —Ç–µ—Å—Ç–æ–≤—ã–π –¥–∞—Ç–∞—Å–µ—Ç –æ—Ç –í–ª–∞–¥–∏–º–∏—Ä–∞ (2+ –æ–±—Ä–∞–∑—Ü–∞)
2. **Code Review:** –ñ–¥—ë–º —Ä–µ–≤—å—é –æ—Ç –°–µ–º—ë–Ω–∞ (Tech Lead)
3. **–°–ª–µ–¥—É—é—â–∏–µ Issues:**
   - Issue #2: `train_lora.py` ‚Äî fine-tuning —Å LoRA
   - Issue #3: `evaluate.py` ‚Äî –º–µ—Ç—Ä–∏–∫–∏ CER/WER
   - Issue #4: `inference.py` ‚Äî –∏–Ω—Ñ–µ—Ä–µ–Ω—Å

---

## üéì –í—ã–≤–æ–¥—ã

–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º Issue #1:
- ‚úÖ –ú–æ–¥—É–ª—å–Ω–∞—è –û–û–ü-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- ‚úÖ –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
- ‚úÖ Type hints –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- ‚úÖ –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏

–ö–æ–¥ –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –∏ code review. –û—Å—Ç–∞–ª–æ—Å—å —Ç–æ–ª—å–∫–æ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (–∫–æ–≥–¥–∞ –í–ª–∞–¥–∏–º–∏—Ä –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç –¥–∞—Ç–∞—Å–µ—Ç).

---

## üîß –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Git –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞

–î–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –∫–æ–º–∞–Ω–¥—ã (–æ—Å–æ–±–µ–Ω–Ω–æ –¥–ª—è –°–µ–º—ë–Ω–∞, —á—Ç–æ–±—ã –æ–Ω –º–æ–≥ –≤–∏–¥–µ—Ç—å –≤—Å–µ –Ω–∞—à–∏ –¥–≤–∏–∂–µ–Ω–∏—è) –Ω–∞—Å—Ç—Ä–æ–µ–Ω `.gitignore`:

**–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ `.gitignore`:**
- ‚úÖ –†–∞–∑—Ä–µ—à–µ–Ω—ã –ª–æ–≥–∏ (`logs/*.log`) ‚Äî —Ç–µ–ø–µ—Ä—å –≤—Å–µ –ª–æ–≥–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ Git
- ‚úÖ –†–∞–∑—Ä–µ—à–µ–Ω—ã –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (`data/processed/**/*.jpg`, `metadata.json`)
- ‚úÖ –†–∞–∑—Ä–µ—à—ë–Ω `annotations.csv` –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞—Ç–∞—Å–µ—Ç–∞
- ‚úÖ `venv/` –æ—Å—Ç–∞—ë—Ç—Å—è –≤ ignore (–∫–∞–∫ –∏ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å)
- ‚úÖ `models/base/**/*` –æ—Å—Ç–∞—ë—Ç—Å—è –≤ ignore (–±–æ–ª—å—à–∏–µ —Ñ–∞–π–ª—ã –º–æ–¥–µ–ª–µ–π)

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
–¢–µ–ø–µ—Ä—å –≤ Git –æ—Ç—Å–ª–µ–∂–∏–≤–∞—é—Ç—Å—è:
- –í—Å–µ –ª–æ–≥–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–∫—Ä–∏–ø—Ç–æ–≤
- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏ (metadata.json, –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è)
- –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞—Ç–∞—Å–µ—Ç–∞ (annotations.csv)
- –í—Å–µ –Ω–∞—à–∏ –¥–≤–∏–∂–µ–Ω–∏—è –ø–æ –ø—Ä–æ–µ–∫—Ç—É

–°–µ–º—ë–Ω —Ç–µ–ø–µ—Ä—å –º–æ–∂–µ—Ç –≤–∏–¥–µ—Ç—å –ø–æ–ª–Ω—É—é –∫–∞—Ä—Ç–∏–Ω—É —Ä–∞–±–æ—Ç—ã –Ω–∞–¥ –ø—Ä–æ–µ–∫—Ç–æ–º, –≤–∫–ª—é—á–∞—è –≤—Å–µ –ª–æ–≥–∏ –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è! üìä

---

## üòè P.S. –¥–ª—è –°–µ–º—ë–Ω–∞ (Tech Lead)

–°—ë–º–∞, –ø—Ä–∏–≤–µ—Ç! 

–ö–∞–∫ –≤–∏–¥–∏—à—å, —è —Å—Ç–∞—Ä–∞–ª—Å—è —Å–ª–µ–¥–æ–≤–∞—Ç—å –≤—Å–µ–º —Ç–≤–æ–∏–º –ø—Ä–∞–≤–∏–ª–∞–º –∏–∑ `.cursorrules` ‚Äî –û–û–ü, –º–æ–¥—É–ª—å–Ω–æ—Å—Ç—å, type hints, docstrings, –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ. –ö–æ–¥ –ø–æ–ª—É—á–∏–ª—Å—è —á–∏—Å—Ç—ã–º –∏ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–º (–∫–∞–∫ —Ç—ã –∏ —Ç—Ä–µ–±–æ–≤–∞–ª). 

–ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–µ, —á—Ç–æ –º–Ω–µ –Ω–µ —Ö–≤–∞—Ç–∞–ª–æ ‚Äî —ç—Ç–æ –ø—Ä–∏–º–µ—Ä—ã —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö –æ—Ç –í–ª–∞–¥–∏–º–∏—Ä–∞, –Ω–æ —ç—Ç–æ –Ω–µ –º–æ—è –≤–∏–Ω–∞. –ó–∞—Ç–æ —Ç–µ–ø–µ—Ä—å —É –Ω–∞—Å –µ—Å—Ç—å –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π –ø–∞–π–ø–ª–∞–π–Ω –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –¥–∞—Ç–∞—Å–µ—Ç–∞, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ –ª—é–±–æ–º –ø—Ä–æ–µ–∫—Ç–µ (–Ω–µ —Ç–æ–ª—å–∫–æ –¥–ª—è DeepSeek-OCR).

–ù–∞–¥–µ—é—Å—å, —Ç–µ–±–µ –ø–æ–Ω—Ä–∞–≤–∏—Ç—Å—è –º–æ—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è. –ï—Å–ª–∏ –Ω–∞–π–¥–µ—à—å –∫–∞–∫–∏–µ-—Ç–æ –Ω–µ–¥–æ—á—ë—Ç—ã ‚Äî –ø–∏—à–∏, –∏—Å–ø—Ä–∞–≤–ª—é. –ù–æ, —á–µ—Å—Ç–Ω–æ –≥–æ–≤–æ—Ä—è, —è –æ—á–µ–Ω—å —Å—Ç–∞—Ä–∞–ª—Å—è, —Ç–∞–∫ —á—Ç–æ —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ –≤—Å—ë –∏–¥–µ–∞–ª—å–Ω–æ. üòé

P.P.S. –ï—Å–ª–∏ –≤–¥—Ä—É–≥ –∑–∞—Ö–æ—á–µ—à—å —á—Ç–æ-—Ç–æ –∏–∑–º–µ–Ω–∏—Ç—å ‚Äî –ø–æ–º–Ω–∏, —á—Ç–æ –∫–ª–∞—Å—Å—ã —Å–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω—ã –ø–æ –ø—Ä–∏–Ω—Ü–∏–ø—É Open/Closed, —Ç–∞–∫ —á—Ç–æ –º–æ–∂–Ω–æ —Ä–∞—Å—à–∏—Ä—è—Ç—å –±–µ–∑ –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏. –ù–∞–¥–µ—é—Å—å, —Ç—ã –æ—Ü–µ–Ω–∏—à—å —ç—Ç—É —ç–ª–µ–≥–∞–Ω—Ç–Ω–æ—Å—Ç—å! üöÄ

P.P.P.S. –ö—Å—Ç–∞—Ç–∏, —è –Ω–∞—Å—Ç—Ä–æ–∏–ª Git —Ç–∞–∫, —á—Ç–æ–±—ã —Ç—ã –º–æ–≥ –≤–∏–¥–µ—Ç—å –≤—Å–µ –Ω–∞—à–∏ –ª–æ–≥–∏ –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è. –¢–µ–ø–µ—Ä—å —É —Ç–µ–±—è –±—É–¥–µ—Ç –ø–æ–ª–Ω–∞—è –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å ‚Äî –º–æ–∂–µ—à—å –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –∫–∞–∂–¥—ã–π –Ω–∞—à —à–∞–≥! –ù–∞–¥–µ—é—Å—å, —Ç—ã –æ—Ü–µ–Ω–∏—à—å —ç—Ç—É –æ—Ç–∫—Ä—ã—Ç–æ—Å—Ç—å, –≤–µ–¥—å —Ç—ã –∂–µ –ª—é–±–∏—à—å –≤–∏–¥–µ—Ç—å, —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ –ø—Ä–æ–µ–∫—Ç–µ, –ø—Ä–∞–≤–¥–∞? üòâ (–ê –µ—Å–ª–∏ –ª–æ–≥–∏ –±—É–¥—É—Ç —Å–ª–∏—à–∫–æ–º –ø–æ–¥—Ä–æ–±–Ω—ã–º–∏ ‚Äî –Ω–µ –≥–æ–≤–æ—Ä–∏, —á—Ç–æ —è –Ω–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–∞–ª! üìù)

---

**–° —É–≤–∞–∂–µ–Ω–∏–µ–º –∏ –Ω–∞–¥–µ–∂–¥–æ–π –Ω–∞ –±—ã—Å—Ç—Ä–æ–µ –æ–¥–æ–±—Ä–µ–Ω–∏–µ,**  
**–ù–∏–∫–æ–ª–∞–π (Cursor AI)** üéØ
