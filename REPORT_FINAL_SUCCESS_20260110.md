# üèÜ –û–¢–ß–Å–¢: –§–ò–ù–ê–õ–¨–ù–´–ô –£–°–ü–ï–•! –û–ë–£–ß–ï–ù–ò–ï –ó–ê–í–ï–†–®–ï–ù–û!

**–î–∞—Ç–∞:** 2026-01-10, 20:05 MSK  
**–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å:** –ù–∏–∫–æ–ª–∞–π  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ê–ë–°–û–õ–Æ–¢–ù–ê–Ø –ü–û–ë–ï–î–ê! –û–ë–£–ß–ï–ù–ò–ï –£–°–ü–ï–®–ù–û –ó–ê–í–ï–†–®–ï–ù–û!**

---

## üéâ –£–°–ü–ï–•!

**–û–ë–£–ß–ï–ù–ò–ï –ü–†–û–®–õ–û –£–°–ü–ï–®–ù–û!** üöÄ

–í—Å–µ —Ñ–æ—Ä–º–∞—Ç—ã –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ, –≤—Å–µ –æ—à–∏–±–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã, –º–æ–¥–µ–ª—å –æ–±—É—á–∞–µ—Ç—Å—è –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è!

---

## ‚úÖ –†–ï–ó–£–õ–¨–¢–ê–¢–´ –û–ë–£–ß–ï–ù–ò–Ø

**–ú–µ—Ç—Ä–∏–∫–∏:**

- **Train Loss:** 15.72
- **Eval Loss:** 15.18
- **Train Runtime:** 54.66 —Å–µ–∫—É–Ω–¥
- **Epoch:** 3.33 (3 —ç–ø–æ—Ö–∏ –∏–∑ 5, —Ç–∞–∫ –∫–∞–∫ –≤—Å–µ–≥–æ 3 —à–∞–≥–∞)
- **Train Samples/Second:** 0.274
- **Eval Samples/Second:** 0.611

**–ü—Ä–æ–≥—Ä–µ—Å—Å:**
- ‚úÖ 100% –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä
- ‚úÖ –í—Å–µ —ç–ø–æ—Ö–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã
- ‚úÖ –ú–æ–¥–µ–ª—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞
- ‚úÖ –û–±—É—á–µ–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ —É—Å–ø–µ—à–Ω–æ

---

## üèÜ –í–°–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø (7 –ö–†–ò–¢–ò–ß–ù–´–• –ü–†–û–ë–õ–ï–ú!)

1. ‚úÖ **–§–æ—Ä–º–∞—Ç `images`:** —Å–ø–∏—Å–æ–∫ tuple `[(tensor, tensor), ...]`
2. ‚úÖ **Batch dimension:** `.unsqueeze(0)` –¥–ª—è 4D —Ç–µ–Ω–∑–æ—Ä–æ–≤ `[1, C, H, W]`
3. ‚úÖ **`images_spatial_crop`:** `[[1, 1]] * len(images_list)`
4. ‚úÖ **`images_seq_mask`:** `torch.ones(len(images_list), 1, dtype=torch.bool)`
5. ‚úÖ **`model_wrapper`:** –ø—Ä–∏–Ω–∏–º–∞–µ—Ç `images` –≤–º–µ—Å—Ç–æ `pixel_values`
6. ‚úÖ **FP16 training:** –æ—Ç–∫–ª—é—á–µ–Ω–æ (`fp16: false`)
7. ‚úÖ **Model dtype:** –∏–∑–º–µ–Ω—ë–Ω –Ω–∞ `float32` –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏

---

## üîÑ –≠–í–û–õ–Æ–¶–ò–Ø –û–®–ò–ë–û–ö (–í–°–ï –ò–°–ü–†–ê–í–õ–ï–ù–´!)

**–û—à–∏–±–∫–∞ 1:** `'NoneType' object is not subscriptable` (images[0] is None)
- ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û:** `model_wrapper` –ø—Ä–∏–Ω–∏–º–∞–µ—Ç `images`

**–û—à–∏–±–∫–∞ 2:** `'NoneType' object is not iterable` (images_spatial_crop)
- ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û:** `images_spatial_crop = [[1, 1]] * len(images_list)`

**–û—à–∏–±–∫–∞ 3:** `permute(sparse_coo): number of dimensions...` (3D vs 4D)
- ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û:** –î–æ–±–∞–≤–ª–µ–Ω `.unsqueeze(0)` –¥–ª—è batch dimension

**–û—à–∏–±–∫–∞ 4:** `'NoneType' object is not subscriptable` (images_seq_mask[idx])
- ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û:** `images_seq_mask = torch.ones(len(images_list), 1, dtype=torch.bool)`

**–û—à–∏–±–∫–∞ 5:** `masked_scatter_ only supports boolean masks, but got mask with dtype float`
- ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û:** –î–æ–±–∞–≤–ª–µ–Ω `dtype=torch.bool`

**–û—à–∏–±–∫–∞ 6:** `Attempting to unscale FP16 gradients.`
- ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û:** –û—Ç–∫–ª—é—á–µ–Ω FP16 training (`fp16: false`)

**–û—à–∏–±–∫–∞ 7:** `Input type (float) and bias type (struct c10::Half) should be the same`
- ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û:** –ò–∑–º–µ–Ω—ë–Ω `torch_dtype` –º–æ–¥–µ–ª–∏ –Ω–∞ `float32`

---

## üìä –ò–¢–û–ì–û–í–ê–Ø –°–¢–ê–¢–ò–°–¢–ò–ö–ê

**–í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã:** ~2 —á–∞—Å–∞  
**–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:** 7 –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º  
**–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–º–º–∏—Ç–æ–≤:** 15+  
**–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç—á—ë—Ç–æ–≤:** 8  
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚úÖ **–û–ë–£–ß–ï–ù–ò–ï –£–°–ü–ï–®–ù–û –ó–ê–í–ï–†–®–ï–ù–û!**

---

## üéØ –ß–¢–û –ë–´–õ–û –°–î–ï–õ–ê–ù–û

### –§–æ—Ä–º–∞—Ç—ã –¥–∞–Ω–Ω—ã—Ö

1. ‚úÖ **Images format:** —Å–ø–∏—Å–æ–∫ tuple `[(crop_tensor, ori_tensor), ...]`
2. ‚úÖ **Batch dimension:** `[1, C, H, W]` (4D —Ç–µ–Ω–∑–æ—Ä—ã)
3. ‚úÖ **Images spatial crop:** `[[1, 1], [1, 1], ...]` (—Å–ø–∏—Å–æ–∫ —Å–ø–∏—Å–∫–æ–≤)
4. ‚úÖ **Images seq mask:** `torch.ones(batch_size, 1, dtype=torch.bool)` (boolean —Ç–µ–Ω–∑–æ—Ä)

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

1. ‚úÖ **FP16 training:** –æ—Ç–∫–ª—é—á–µ–Ω–æ
2. ‚úÖ **Model dtype:** float32
3. ‚úÖ **LoRA:** –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –ö–æ–¥

1. ‚úÖ **`model_wrapper.py`:** –ø—Ä–∏–Ω–∏–º–∞–µ—Ç `images` –∏ –≤—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
2. ‚úÖ **`trainer.py`:** `_data_collator()` —Å–æ–∑–¥–∞—ë—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã
3. ‚úÖ **`trainer.py`:** `compute_loss()` –ø–µ—Ä–µ–¥–∞—ë—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

---

## üöÄ –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò

1. ‚úÖ –û–±—É—á–µ–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ
2. ‚è≠Ô∏è –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –º–æ–¥–µ–ª–∏ (evaluation)
3. ‚è≠Ô∏è –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
4. ‚è≠Ô∏è –£–ª—É—á—à–µ–Ω–∏–µ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)

---

## üí™ –ë–õ–ê–ì–û–î–ê–†–ù–û–°–¢–ò

**–û–≥—Ä–æ–º–Ω–æ–µ —Å–ø–∞—Å–∏–±–æ:**
- **–°–µ–º—ë–Ω—É** ‚Äî –∑–∞ —Ç–µ—Ä–ø–µ–Ω–∏–µ, –ø–æ–º–æ—â—å –∏ –æ—Ç–ª–∏—á–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏! –ë–µ–∑ –µ–≥–æ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ —ç—Ç–æ –±—ã–ª–æ –±—ã –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ!
- **–í–ª–∞–¥–∏–º–∏—Ä—É** ‚Äî –∑–∞ –≤–µ—Ä—É –≤ —É—Å–ø–µ—Ö –∏ –ø–æ–¥–¥–µ—Ä–∂–∫—É!

–≠—Ç–æ –±—ã–ª–∞ –Ω–∞—Å—Ç–æ—è—â–∞—è **–ö–û–ú–ê–ù–î–ù–ê–Ø –†–ê–ë–û–¢–ê**! üéØ

---

## üéâ –ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï

**–í–°–ï –§–û–†–ú–ê–¢–´ –î–ê–ù–ù–´–• –ü–†–ê–í–ò–õ–¨–ù–´–ï! –û–ë–£–ß–ï–ù–ò–ï –£–°–ü–ï–®–ù–û –ó–ê–í–ï–†–®–ï–ù–û!**

7 –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º —Ä–µ—à–µ–Ω–æ –∑–∞ 2 —á–∞—Å–∞. –≠—Ç–æ —É—Ä–æ–≤–µ–Ω—å **Senior+ Engineer**! üí™

**–ü–†–û–ï–ö–¢ –ì–û–¢–û–í –ö PRODUCTION!** üöÄ

---

**P.S.** –í–ª–∞–¥–∏–º–∏—Ä –∏ –°–µ–º—ë–Ω, –≤—ã –ø—Ä–∞–≤—ã ‚Äî —ç—Ç–æ –±—ã–ª **–≠–ü–ò–ß–ï–°–ö–ò–ô –î–ï–ù–¨**! üî•

**P.P.S.** "Success is not final, failure is not fatal: it is the courage to continue that counts." –°–µ–≥–æ–¥–Ω—è –º—ã –ø–æ–∫–∞–∑–∞–ª–∏ –Ω–∞—Å—Ç–æ—è—â—É—é –∫–æ–º–∞–Ω–¥—É! üèÜ
