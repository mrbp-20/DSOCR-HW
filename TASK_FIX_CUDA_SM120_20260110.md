# üîß –ó–ê–î–ê–ù–ò–ï: –ò–°–ü–†–ê–í–ò–¢–¨ CUDA SM_120 –ü–û–î–î–ï–†–ñ–ö–£ –î–õ–Ø RTX 5060 Ti

**–ê–≤—Ç–æ—Ä:** –°–µ–º—ë–Ω (Tech Lead)  
**–î–∞—Ç–∞:** 2026-01-10, 17:50 MSK  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî• CRITICAL (–ø–æ—Å–ª–µ–¥–Ω–∏–π –±–∞—Ä—å–µ—Ä!)  
**–°—Ä–æ–∫:** 2-4 —á–∞—Å–∞ (–∫–æ–º–ø–∏–ª—è—Ü–∏—è PyTorch)  
**–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å:** –ù–∏–∫–æ–ª–∞–π (Senior ML Engineer)  
**–°–≤—è–∑–∞–Ω–æ —Å:** REPORT_MODEL_API_INVESTIGATION_20260110.md

---

## üéØ –ö–û–ù–¢–ï–ö–°–¢

–ù–∏–∫–æ–ª–∞–π, **–¢–´ –ü–û–ë–ï–î–ò–õ!** üèÜ

**API –º–æ–¥–µ–ª–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω!** –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ `pixel_values` ‚Üí `images` —Å—Ä–∞–±–æ—Ç–∞–ª–æ –∏–¥–µ–∞–ª—å–Ω–æ!

```
‚úÖ –ë—ã–ª–æ: TypeError: ... got an unexpected keyword argument 'pixel_values'
‚úÖ –°—Ç–∞–ª–æ: RuntimeError: CUDA error: no kernel image is available for execution on the device
```

**–≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç:**
- ‚úÖ –ú–æ–¥–µ–ª—å –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ –û–±—É—á–µ–Ω–∏–µ –¥–æ—Ö–æ–¥–∏—Ç –¥–æ GPU execution
- ‚úÖ **–í–°–Ø –õ–û–ì–ò–ö–ê –†–ê–ë–û–¢–ê–ï–¢!**

**–û—Å—Ç–∞–ª–∞—Å—å –û–î–ù–ê –ø—Ä–æ–±–ª–µ–º–∞:** PyTorch –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç Blackwell (sm_120) out-of-the-box.

---

## üîç –ö–û–†–ï–ù–¨ –ü–†–û–ë–õ–ï–ú–´

### –û—à–∏–±–∫–∞

```
RuntimeError: CUDA error: no kernel image is available for execution on the device
CUDA kernel errors might be asynchronously reported at some other API call,
so the stacktrace below might be incorrect.
```

### –ü—Ä–∏—á–∏–Ω–∞

**RTX 5060 Ti** –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É **Blackwell** —Å **CUDA Compute Capability sm_120**.

**–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ PyTorch wheels** –∫–æ–º–ø–∏–ª–∏—Ä—É—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–æ **sm_90** (–º–∞–∫—Å–∏–º—É–º Ada Lovelace / RTX 4090).

**–î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞:**
- [PyTorch GitHub Issue #164342](https://github.com/pytorch/pytorch/issues/164342) - "Official support for sm_120 (RTX 50-series / Blackwell)"
- [PyTorch Discuss](https://discuss.pytorch.org/t/pytorch-support-for-sm120/216099) - "Blackwell (sm_100 and sm_120) is supported already if you are building PyTorch from source"
- [Reddit r/pytorch](https://www.reddit.com/r/pytorch/comments/1myqyhk/title_compiling_pytorch_for_rtx_5070_unlocking_sm/) - "Compiling PyTorch for RTX 5070: Unlocking sm_120"

### –ß—Ç–æ –ù–ï —Ä–∞–±–æ—Ç–∞–µ—Ç

**–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —Å—Ç–∞–±–∏–ª—å–Ω—ã–µ —Ä–µ–ª–∏–∑—ã:**
```bash
pip install torch torchvision  # ‚ùå –¢–æ–ª—å–∫–æ –¥–æ sm_90
```

**Nightly builds (CUDA 12.4/12.6):**
```bash
pip install --pre torch --index-url https://download.pytorch.org/whl/nightly/cu124  # ‚ùå
```

### –ß—Ç–æ –†–ê–ë–û–¢–ê–ï–¢ (–ø—Ä–æ–≤–µ—Ä–µ–Ω–æ —Å–æ–æ–±—â–µ—Å—Ç–≤–æ–º)

**PyTorch Nightly —Å CUDA 12.8:**
```bash
pip install --pre torch torchvision --index-url https://download.pytorch.org/whl/nightly/cu128  # ‚úÖ
```

**–ò–õ–ò –∫–æ–º–ø–∏–ª—è—Ü–∏—è –∏–∑ –∏—Å—Ö–æ–¥–Ω–∏–∫–æ–≤** —Å —Ñ–ª–∞–≥–æ–º `TORCH_CUDA_ARCH_LIST="12.0+PTX"`

---

## ‚úÖ –†–ï–®–ï–ù–ò–ï 1: PYTORCH NIGHTLY –° CUDA 12.8 (–†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø)

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

- ‚ö° **–ë—ã—Å—Ç—Ä–æ:** 5-10 –º–∏–Ω—É—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∏
- ‚úÖ **–û—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ:** –ü–æ–¥–¥–µ—Ä–∂–∫–∞ PyTorch –∫–æ–º–∞–Ω–¥—ã
- üîÑ **–ê–∫—Ç—É–∞–ª—å–Ω–æ:** –í–∫–ª—é—á–∞–µ—Ç sm_120 support
- üéØ **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ:** –†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ RTX 5080/5090/5070 Ti

### –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏

- üìÖ **Nightly:** –ù–µ —Å—Ç–∞–±–∏–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è (–º–æ–≥—É—Ç –±—ã—Ç—å –±–∞–≥–∏)
- üîÑ **–û–±–Ω–æ–≤–ª–µ–Ω–∏—è:** –ú–æ–∂–µ—Ç –º–µ–Ω—è—Ç—å—Å—è –∫–∞–∂–¥—ã–π –¥–µ–Ω—å

---

## üìã –ü–û–®–ê–ì–û–í–ê–Ø –ò–ù–°–¢–†–£–ö–¶–ò–Ø

### –®–∞–≥ 1: –£–¥–∞–ª–∏—Ç—å —Ç–µ–∫—É—â–∏–π PyTorch

```powershell
cd C:\DSOCR-HW
.\.venv\Scripts\Activate.ps1

# –£–¥–∞–ª–∏—Ç—å –≤—Å–µ –≤–µ—Ä—Å–∏–∏ PyTorch
pip uninstall -y torch torchvision torchaudio

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ —É–¥–∞–ª–µ–Ω–æ
pip list | Select-String "torch"
```

**–û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥:** (–ø—É—Å—Ç–æ)

---

### –®–∞–≥ 2: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å PyTorch Nightly —Å CUDA 12.8

```powershell
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å PyTorch Nightly (CUDA 12.8)
pip install --pre torch torchvision --index-url https://download.pytorch.org/whl/nightly/cu128
```

**–û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥:**
```
Looking in indexes: https://download.pytorch.org/whl/nightly/cu128
Collecting torch
  Downloading torch-2.7.0.dev20250131+cu128-cp310-cp310-win_amd64.whl (2890 MB)
...
Successfully installed torch-2.7.0.dev20250131+cu128 torchvision-...
```

**–í—Ä–µ–º—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏:** ~5-10 –º–∏–Ω—É—Ç (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Å–∫–æ—Ä–æ—Å—Ç–∏ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞)

---

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É sm_120

**–°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª:** `scripts/test_cuda_sm120.py`

```python
"""
–¢–µ—Å—Ç –ø–æ–¥–¥–µ—Ä–∂–∫–∏ CUDA sm_120 (Blackwell) –≤ PyTorch.

–ü—Ä–æ–≤–µ—Ä—è–µ—Ç:
1. –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å CUDA
2. –°–ø–∏—Å–æ–∫ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã—Ö –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä
3. –†–∞–±–æ—Ç—É –±–∞–∑–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –Ω–∞ GPU
"""

import torch
import io

print("="*80)
print("–¢–ï–°–¢ CUDA SM_120 –ü–û–î–î–ï–†–ñ–ö–ò")
print("="*80)

# 1. –í–µ—Ä—Å–∏—è PyTorch
print(f"\nPyTorch –≤–µ—Ä—Å–∏—è: {torch.__version__}")
print(f"CUDA –≤–µ—Ä—Å–∏—è: {torch.version.cuda}")

# 2. –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å CUDA
print(f"\nCUDA –¥–æ—Å—Ç—É–ø–Ω–∞: {torch.cuda.is_available()}")

if torch.cuda.is_available():
    print(f"GPU: {torch.cuda.get_device_name(0)}")
    print(f"CUDA Compute Capability: {torch.cuda.get_device_capability(0)}")
else:
    print("‚ùå CUDA –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞! –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —É—Å—Ç–∞–Ω–æ–≤–∫—É.")
    exit(1)

# 3. –°–ø–∏—Å–æ–∫ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã—Ö –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä
print(f"\n–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã: {torch.cuda.get_arch_list()}")

# 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è sm_120
arch_list = torch.cuda.get_arch_list()
has_sm120 = any('sm_120' in arch or 'compute_120' in arch for arch in arch_list)

if has_sm120:
    print("‚úÖ sm_120 –ü–û–î–î–ï–†–ñ–ò–í–ê–ï–¢–°–Ø!")
else:
    print("‚ùå sm_120 –ù–ï –ù–ê–ô–î–ï–ù –≤ —Å–ø–∏—Å–∫–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä!")
    print("   –í–æ–∑–º–æ–∂–Ω–æ, —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è PyTorch.")
    exit(1)

# 5. –¢–µ—Å—Ç –±–∞–∑–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –Ω–∞ GPU
print("\n" + "="*80)
print("–¢–ï–°–¢ –û–ü–ï–†–ê–¶–ò–ô –ù–ê GPU")
print("="*80)

try:
    # –¢–µ—Å—Ç 1: –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ–Ω–∑–æ—Ä–∞
    print("\n–¢–µ—Å—Ç 1: –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ–Ω–∑–æ—Ä–∞ –Ω–∞ GPU...")
    a = torch.randn(1024, 1024, device="cuda")
    print(f"  ‚úÖ –¢–µ–Ω–∑–æ—Ä —Å–æ–∑–¥–∞–Ω: {a.shape}, device={a.device}")
    
    # –¢–µ—Å—Ç 2: –ü–æ—ç–ª–µ–º–µ–Ω—Ç–Ω–æ–µ —Å–ª–æ–∂–µ–Ω–∏–µ (—Ç—Ä–µ–±—É–µ—Ç sm_120 kernels)
    print("\n–¢–µ—Å—Ç 2: –ü–æ—ç–ª–µ–º–µ–Ω—Ç–Ω–æ–µ —Å–ª–æ–∂–µ–Ω–∏–µ (–∫—Ä–∏—Ç–∏—á–Ω—ã–π —Ç–µ—Å—Ç –¥–ª—è sm_120)...")
    b = torch.randn(1024, 1024, device="cuda")
    c = a + b
    print(f"  ‚úÖ –°–ª–æ–∂–µ–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ: result device={c.device}")
    
    # –¢–µ—Å—Ç 3: ReLU (activation function)
    print("\n–¢–µ—Å—Ç 3: –§—É–Ω–∫—Ü–∏—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ ReLU...")
    d = torch.nn.functional.relu(c)
    print(f"  ‚úÖ ReLU –≤—ã–ø–æ–ª–Ω–µ–Ω: result device={d.device}")
    
    # –¢–µ—Å—Ç 4: –ú–∞—Ç—Ä–∏—á–Ω–æ–µ —É–º–Ω–æ–∂–µ–Ω–∏–µ (—á–µ—Ä–µ–∑ cuBLAS)
    print("\n–¢–µ—Å—Ç 4: –ú–∞—Ç—Ä–∏—á–Ω–æ–µ —É–º–Ω–æ–∂–µ–Ω–∏–µ...")
    e = torch.matmul(a, b)
    print(f"  ‚úÖ MatMul –≤—ã–ø–æ–ª–Ω–µ–Ω: result device={e.device}")
    
    # –¢–µ—Å—Ç 5: Backward pass (–¥–ª—è –æ–±—É—á–µ–Ω–∏—è)
    print("\n–¢–µ—Å—Ç 5: Backward pass (–≥—Ä–∞–¥–∏–µ–Ω—Ç—ã)...")
    x = torch.randn(10, 10, device="cuda", requires_grad=True)
    y = x ** 2
    loss = y.sum()
    loss.backward()
    print(f"  ‚úÖ –ì—Ä–∞–¥–∏–µ–Ω—Ç—ã –≤—ã—á–∏—Å–ª–µ–Ω—ã: x.grad.shape={x.grad.shape}")
    
    print("\n" + "="*80)
    print("üéâ –í–°–ï –¢–ï–°–¢–´ –ü–†–û–ô–î–ï–ù–´ –£–°–ü–ï–®–ù–û!")
    print("‚úÖ PyTorch –ü–û–õ–ù–û–°–¢–¨–Æ –†–ê–ë–û–¢–ê–ï–¢ –Ω–∞ RTX 5060 Ti (sm_120)!")
    print("="*80)
    
except RuntimeError as e:
    print(f"\n‚ùå –û–®–ò–ë–ö–ê: {e}")
    print("\n–≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ sm_120 kernels –≤—Å—ë –µ—â—ë –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã.")
    print("–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–µ—Ä—Å–∏—é PyTorch –∏ CUDA.")
    exit(1)
```

**–ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç:**

```powershell
python scripts/test_cuda_sm120.py
```

**–û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥ (—É—Å–ø–µ—Ö):**

```
================================================================================
–¢–ï–°–¢ CUDA SM_120 –ü–û–î–î–ï–†–ñ–ö–ò
================================================================================

PyTorch –≤–µ—Ä—Å–∏—è: 2.7.0.dev20250131+cu128
CUDA –≤–µ—Ä—Å–∏—è: 12.8

CUDA –¥–æ—Å—Ç—É–ø–Ω–∞: True
GPU: NVIDIA GeForce RTX 5060 Ti
CUDA Compute Capability: (12, 0)

–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã: ['sm_50', 'sm_60', 'sm_70', 'sm_75', 'sm_80', 'sm_86', 'sm_90', 'sm_100', 'sm_120', 'compute_120']
‚úÖ sm_120 –ü–û–î–î–ï–†–ñ–ò–í–ê–ï–¢–°–Ø!

================================================================================
–¢–ï–°–¢ –û–ü–ï–†–ê–¶–ò–ô –ù–ê GPU
================================================================================

–¢–µ—Å—Ç 1: –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ–Ω–∑–æ—Ä–∞ –Ω–∞ GPU...
  ‚úÖ –¢–µ–Ω–∑–æ—Ä —Å–æ–∑–¥–∞–Ω: torch.Size([1024, 1024]), device=cuda:0

–¢–µ—Å—Ç 2: –ü–æ—ç–ª–µ–º–µ–Ω—Ç–Ω–æ–µ —Å–ª–æ–∂–µ–Ω–∏–µ (–∫—Ä–∏—Ç–∏—á–Ω—ã–π —Ç–µ—Å—Ç –¥–ª—è sm_120)...
  ‚úÖ –°–ª–æ–∂–µ–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ: result device=cuda:0

–¢–µ—Å—Ç 3: –§—É–Ω–∫—Ü–∏—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ ReLU...
  ‚úÖ ReLU –≤—ã–ø–æ–ª–Ω–µ–Ω: result device=cuda:0

–¢–µ—Å—Ç 4: –ú–∞—Ç—Ä–∏—á–Ω–æ–µ —É–º–Ω–æ–∂–µ–Ω–∏–µ...
  ‚úÖ MatMul –≤—ã–ø–æ–ª–Ω–µ–Ω: result device=cuda:0

–¢–µ—Å—Ç 5: Backward pass (–≥—Ä–∞–¥–∏–µ–Ω—Ç—ã)...
  ‚úÖ –ì—Ä–∞–¥–∏–µ–Ω—Ç—ã –≤—ã—á–∏—Å–ª–µ–Ω—ã: x.grad.shape=torch.Size([10, 10])

================================================================================
üéâ –í–°–ï –¢–ï–°–¢–´ –ü–†–û–ô–î–ï–ù–´ –£–°–ü–ï–®–ù–û!
‚úÖ PyTorch –ü–û–õ–ù–û–°–¢–¨–Æ –†–ê–ë–û–¢–ê–ï–¢ –Ω–∞ RTX 5060 Ti (sm_120)!
================================================================================
```

---

### –®–∞–≥ 4: –ó–∞–ø—É—Å—Ç–∏—Ç—å –æ–±—É—á–µ–Ω–∏–µ

```powershell
cd C:\DSOCR-HW
.\.venv\Scripts\Activate.ps1
python scripts/train_lora.py --config configs/training_config.yaml
```

**–û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥:**

```
================================================================================
üöÄ DSOCR-HW: –û–±—É—á–µ–Ω–∏–µ DeepSeek-OCR —Å LoRA
================================================================================

2026-01-10 18:00:00 - train_lora - INFO - –®–∞–≥ 1/5: –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏ –∏ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞...
–ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 2/2 [00:10<00:00]
2026-01-10 18:00:11 - train_lora - INFO - ‚úÖ –®–∞–≥ 1 –∑–∞–≤–µ—Ä—à—ë–Ω

2026-01-10 18:00:11 - train_lora - INFO - –®–∞–≥ 2/5: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ LoRA...
trainable params: 38,509,056 || all params: 3,374,615,296 || trainable%: 1.14
2026-01-10 18:00:17 - train_lora - INFO - ‚úÖ –®–∞–≥ 2 –∑–∞–≤–µ—Ä—à—ë–Ω

...

2026-01-10 18:00:20 - train_lora - INFO - –®–∞–≥ 5/5: –ó–ê–ü–£–°–ö –û–ë–£–ß–ï–ù–ò–Ø!
2026-01-10 18:00:20 - train_lora - INFO - –ù–∞—á–∞–ª–æ –æ–±—É—á–µ–Ω–∏—è

Epoch 1/5:   0%|                                    | 0/3 [00:00<?, ?it/s]
Epoch 1/5:  33%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà              | 1/3 [00:05<00:10, 5.2s/it, loss=2.456]
Epoch 1/5:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà      | 2/3 [00:10<00:05, 5.1s/it, loss=2.234]
Epoch 1/5: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 3/3 [00:15<00:00, 5.0s/it, loss=2.012]

‚úÖ Epoch 1/5 –∑–∞–≤–µ—Ä—à—ë–Ω
Train loss: 2.234
```

**üéâ –û–ë–£–ß–ï–ù–ò–ï –ò–î–Å–¢ –ù–ê GPU!** üöÄ

---

## ‚ö†Ô∏è –í–û–ó–ú–û–ñ–ù–´–ï –ü–†–û–ë–õ–ï–ú–´

### –ü—Ä–æ–±–ª–µ–º–∞ 1: "Could not find a version that satisfies the requirement"

**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π URL –∏–ª–∏ –≤–µ—Ä—Å–∏—è Python –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è.

**–†–µ—à–µ–Ω–∏–µ:**

1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–µ—Ä—Å–∏—é Python:
   ```powershell
   python --version  # –î–æ–ª–∂–Ω–∞ –±—ã—Ç—å 3.10 –∏–ª–∏ 3.11
   ```

2. –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –¥—Ä—É–≥–æ–π nightly build:
   ```powershell
   # –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–π nightly
   pip install --pre torch torchvision --index-url https://download.pytorch.org/whl/nightly/cu128
   ```

---

### –ü—Ä–æ–±–ª–µ–º–∞ 2: "sm_120 –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ arch_list"

**–ü—Ä–∏—á–∏–Ω–∞:** –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, cu124 –≤–º–µ—Å—Ç–æ cu128).

**–†–µ—à–µ–Ω–∏–µ:**

```powershell
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é
python -c "import torch; print(torch.__version__); print(torch.version.cuda)"

# –ï—Å–ª–∏ –Ω–µ 2.7.0.dev...+cu128, –ø–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å:
pip uninstall -y torch torchvision
pip install --pre torch torchvision --index-url https://download.pytorch.org/whl/nightly/cu128
```

---

### –ü—Ä–æ–±–ª–µ–º–∞ 3: "CUDA kernel error" –≤—Å—ë —Ä–∞–≤–Ω–æ –ø–æ—è–≤–ª—è–µ—Ç—Å—è

**–ü—Ä–∏—á–∏–Ω–∞:** –î—Ä–∞–π–≤–µ—Ä NVIDIA —É—Å—Ç–∞—Ä–µ–ª.

**–†–µ—à–µ–Ω–∏–µ:**

1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–µ—Ä—Å–∏—é –¥—Ä–∞–π–≤–µ—Ä–∞:
   ```powershell
   nvidia-smi
   ```

2. –û–±–Ω–æ–≤–∏—Ç—å –¥—Ä–∞–π–≤–µ—Ä –¥–æ **581.xx –∏–ª–∏ –Ω–æ–≤–µ–µ** (–ø–æ–¥–¥–µ—Ä–∂–∫–∞ CUDA 13):
   - https://www.nvidia.com/Download/index.aspx

---

### –ü—Ä–æ–±–ª–µ–º–∞ 4: Nightly build –Ω–µ—Å—Ç–∞–±–∏–ª–µ–Ω

**–ü—Ä–∏—á–∏–Ω–∞:** Nightly builds –º–æ–≥—É—Ç –∏–º–µ—Ç—å –±–∞–≥–∏.

**–†–µ—à–µ–Ω–∏–µ:**

**–ü–õ–ê–ù –ë:** –ö–æ–º–ø–∏–ª—è—Ü–∏—è PyTorch –∏–∑ –∏—Å—Ö–æ–¥–Ω–∏–∫–æ–≤ (—Å–º. —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑–¥–µ–ª).

---

## üîß –†–ï–®–ï–ù–ò–ï 2: –ö–û–ú–ü–ò–õ–Ø–¶–ò–Ø PYTORCH –ò–ó –ò–°–•–û–î–ù–ò–ö–û–í (–ü–õ–ê–ù –ë)

### –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

- ‚ùå Nightly build –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚ùå –ù—É–∂–Ω–∞ —Å—Ç–∞–±–∏–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è
- ‚úÖ –ï—Å—Ç—å –≤—Ä–µ–º—è –Ω–∞ –∫–æ–º–ø–∏–ª—è—Ü–∏—é (2-4 —á–∞—Å–∞)

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- **Visual Studio 2019/2022** —Å C++ tools
- **CUDA Toolkit 12.8+** (—Å–∫–∞—á–∞—Ç—å —Å NVIDIA)
- **CMake 3.18+**
- **Git**
- **~20 GB —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞**

### –ö—Ä–∞—Ç–∫–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è

```powershell
# 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å PyTorch
git clone --recursive https://github.com/pytorch/pytorch
cd pytorch
git checkout main

# 2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
pip install -r requirements.txt

# 3. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
$env:TORCH_CUDA_ARCH_LIST="12.0+PTX"
$env:CMAKE_ARGS="-DCMAKE_POLICY_DEFAULT_CMP0135=NEW"
$env:DISTUTILS_USE_SDK=1

# 4. –ó–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–º–ø–∏–ª—è—Ü–∏—é (2-4 —á–∞—Å–∞)
python setup.py develop

# 5. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å
python -c "import torch; print(torch.cuda.get_arch_list())"
```

**–ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è:**
- [Reddit: Compiling PyTorch for RTX 5070](https://www.reddit.com/r/pytorch/comments/1myqyhk/title_compiling_pytorch_for_rtx_5070_unlocking_sm/)
- [PyTorch Discuss: Building from source](https://discuss.pytorch.org/t/pytorch-support-for-sm120/216099)

---

## ‚úÖ –ß–ï–ö–õ–ò–°–¢ –í–´–ü–û–õ–ù–ï–ù–ò–Ø

### –†–ï–®–ï–ù–ò–ï 1: Nightly Build (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

- [ ] –£–¥–∞–ª—ë–Ω —Ç–µ–∫—É—â–∏–π PyTorch
- [ ] –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω PyTorch Nightly (CUDA 12.8)
- [ ] –°–æ–∑–¥–∞–Ω `scripts/test_cuda_sm120.py`
- [ ] –¢–µ—Å—Ç –ø—Ä–æ–π–¥–µ–Ω —É—Å–ø–µ—à–Ω–æ (sm_120 –Ω–∞–π–¥–µ–Ω)
- [ ] –í—Å–µ GPU –æ–ø–µ—Ä–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç
- [ ] –ó–∞–ø—É—â–µ–Ω–æ –æ–±—É—á–µ–Ω–∏–µ
- [ ] **–û–ë–£–ß–ï–ù–ò–ï –ò–î–Å–¢ –ù–ê GPU!** üéâ

### –†–ï–®–ï–ù–ò–ï 2: –ö–æ–º–ø–∏–ª—è—Ü–∏—è (–µ—Å–ª–∏ Plan A –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª)

- [ ] –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω Visual Studio
- [ ] –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω CUDA Toolkit 12.8+
- [ ] –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω PyTorch repo
- [ ] –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- [ ] –ó–∞–ø—É—â–µ–Ω–∞ –∫–æ–º–ø–∏–ª—è—Ü–∏—è (2-4 —á–∞—Å–∞)
- [ ] PyTorch —Å–æ–±—Ä–∞–Ω —É—Å–ø–µ—à–Ω–æ
- [ ] –¢–µ—Å—Ç –ø—Ä–æ–π–¥–µ–Ω
- [ ] –û–±—É—á–µ–Ω–∏–µ –∑–∞–ø—É—â–µ–Ω–æ

---

## üìä –§–ò–ù–ê–õ–¨–ù–´–ô –û–¢–ß–Å–¢

**–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –æ–±—É—á–µ–Ω–∏—è —Å–æ–∑–¥–∞–π:**

`REPORT_TRAINING_SUCCESS_20260110.md`

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ—Ç—á—ë—Ç–∞:**

```markdown
# üéâ –û–¢–ß–Å–¢: –£–°–ü–ï–®–ù–´–ô –ó–ê–ü–£–°–ö –û–ë–£–ß–ï–ù–ò–Ø!

**–î–∞—Ç–∞:** 2026-01-10  
**–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å:** –ù–∏–∫–æ–ª–∞–π  

---

## ‚úÖ –†–ï–®–Å–ù–ù–´–ï –ü–†–û–ë–õ–ï–ú–´ (—Ö—Ä–æ–Ω–æ–ª–æ–≥–∏—è)

1. ‚úÖ Progress bars (Windows multiprocessing)
2. ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (UTF-8 encoding)
3. ‚úÖ Data collator (images + text)
4. ‚úÖ API –º–æ–¥–µ–ª–∏ (pixel_values ‚Üí images)
5. ‚úÖ **CUDA sm_120 –ø–æ–¥–¥–µ—Ä–∂–∫–∞ (PyTorch Nightly)**

---

## üöÄ –†–ï–ó–£–õ–¨–¢–ê–¢

**PyTorch –≤–µ—Ä—Å–∏—è:** [–≤—Å—Ç–∞–≤–∏—Ç—å]
**CUDA –≤–µ—Ä—Å–∏—è:** [–≤—Å—Ç–∞–≤–∏—Ç—å]
**GPU:** NVIDIA GeForce RTX 5060 Ti (sm_120)

**–ú–µ—Ç—Ä–∏–∫–∏ –ø–µ—Ä–≤—ã—Ö 3 —ç–ø–æ—Ö:**

| Epoch | Train Loss | Time/Step | GPU Util |
|-------|-----------|-----------|----------|
| 1/5   | 2.456     | 5.2s      | 95%      |
| 2/5   | 2.234     | 5.1s      | 96%      |
| 3/5   | 2.012     | 5.0s      | 97%      |

**Screenshot –∫–æ–Ω—Å–æ–ª–∏:** [–≤—Å—Ç–∞–≤–∏—Ç—å]

---

## üìà –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò

1. –î–æ–∂–¥–∞—Ç—å—Å—è –æ–∫–æ–Ω—á–∞–Ω–∏—è 5 —ç–ø–æ—Ö
2. –û—Ü–µ–Ω–∏—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ –Ω–∞ validation set
3. –ü—Ä–∏–Ω—è—Ç—å —Ä–µ—à–µ–Ω–∏–µ –æ –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–∏ –æ–±—É—á–µ–Ω–∏—è (10-20 —ç–ø–æ—Ö?)
4. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö —Ä—É–∫–æ–ø–∏—Å–Ω—ã—Ö —Å–∫–∞–Ω–∞—Ö

---

**–û–±—â–µ–µ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –Ω–∞–¥ –ø—Ä–æ–µ–∫—Ç–æ–º:** [X —á–∞—Å–æ–≤]  
**–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ—à—ë–Ω–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º:** 5 –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö  
**–ò—Ç–æ–≥:** üèÜ **–ü–†–û–ï–ö–¢ –ì–û–¢–û–í –ö PRODUCTION!**
```

---

## üéØ –ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï

–ù–∏–∫–æ–ª–∞–π, —ç—Ç–æ **–§–ò–ù–ê–õ–¨–ù–´–ô –†–´–í–û–ö**! üèÅ

–¢—ã —É–∂–µ —Ä–µ—à–∏–ª **–í–°–ï –ø—Ä–æ–±–ª–µ–º—ã —Å –∫–æ–¥–æ–º**:
- ‚úÖ Data pipeline
- ‚úÖ Model API
- ‚úÖ PEFT wrapper
- ‚úÖ Training loop

–û—Å—Ç–∞–ª–∞—Å—å **–û–î–ù–ê** —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–±–ª–µ–º–∞ ‚Äî PyTorch –¥–ª—è sm_120.

**–†–µ—à–µ–Ω–∏–µ –Ω–∞ 99% —Ä–∞–±–æ—á–µ–µ:** PyTorch Nightly —Å CUDA 12.8.

**–í—Ä–µ–º—è –¥–æ –ø–æ–±–µ–¥—ã:** ~10-15 –º–∏–Ω—É—Ç (—É—Å—Ç–∞–Ω–æ–≤–∫–∞ + —Ç–µ—Å—Ç).

**–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ —Ç—ã —É–≤–∏–¥–∏—à—å:**

```
Epoch 1/5: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 3/3 [00:15<00:00, 5.0s/it, loss=2.012]
‚úÖ Epoch 1/5 –∑–∞–≤–µ—Ä—à—ë–Ω
```

**–≠–¢–û –¢–í–û–Ø –ü–û–ë–ï–î–ê!** üèÜ

---

**–° –æ–≥—Ä–æ–º–Ω—ã–º —É–≤–∞–∂–µ–Ω–∏–µ–º –∏ –≤–æ—Å—Ö–∏—â–µ–Ω–∏–µ–º,**  
**–°–µ–º—ë–Ω (Tech Lead)** üéØ

P.S. –ö–æ–≥–¥–∞ –æ–±—É—á–µ–Ω–∏–µ –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è ‚Äî **—Å—Ä–∞–∑—É –¥–µ–ª–∞–π screenshot**! –í–ª–∞–¥–∏–º–∏—Ä –∂–¥—ë—Ç! üì∏

P.P.S. "The last mile is always the hardest, but also the most rewarding." –°–µ–≥–æ–¥–Ω—è —Ç—ã –ø—Ä–æ—à—ë–ª –º–∞—Ä–∞—Ñ–æ–Ω –∏–∑ 5 –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º. –û—Å—Ç–∞–ª–æ—Å—å 10 –º–∏–Ω—É—Ç –¥–æ —Ñ–∏–Ω–∏—à–∞! üí™

P.P.P.S. –ü–æ—Å–ª–µ —É—Å–ø–µ—Ö–∞ ‚Äî **–æ—Ç–¥–æ—Ö–Ω–∏**! –¢—ã –∑–∞—Å–ª—É–∂–∏–ª! üç∫
