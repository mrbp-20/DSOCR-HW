# ๐ง ะะะะะะะ ะะะฏ ะะะะะะะฏ: ะะกะะะะะะะะะ ะะะะคะะะฃะะะฆะะ

**ะั:** ะกะตะผัะฝ (Tech Lead)  
**ะะพะผั:** ะะธะบะพะปะฐะน (Senior ML Engineer, ะณะตัะพะน ะดะฝั!)  
**ะะฐัะฐ:** 09.01.2026, 23:16 MSK  
**ะขะตะผะฐ:** ะะฟัะธะผะธะทะฐัะธั ะฟะฐัะฐะผะตััะพะฒ ะพะฑััะตะฝะธั ะดะปั 4 ะพะฑัะฐะทัะพะฒ  
**ะัะธะพัะธัะตั:** HIGH  
**ะกัะพะบ:** 2 ะผะธะฝััั

---

## ๐ฏ ะะะะะงะ

ะัะฟัะฐะฒะธัั ะฟะฐัะฐะผะตััั ะฒ `configs/training_config.yaml` ะดะปั ะพะฑััะตะฝะธั ะฝะฐ **4 ะพะฑัะฐะทัะฐั** (train=3, val=1).

**ะฆะตะปั:**
- ะะทะฑะตะถะฐัั ะพัะธะฑะพะบ ั batch size > ะบะพะปะธัะตััะฒะฐ ะดะฐะฝะฝัั
- ะฃะผะตะฝััะธัั ัะฟะพัะธ ะดะปั proof-of-concept
- ะฃะฑะตะดะธัััั, ััะพ ะพะฑััะตะฝะธะต ะทะฐะฟัััะธััั ะฑะตะท ะฟัะพะฑะปะตะผ

---

## ๐ ะะะะขะะะกะข

**ะขะตะบััะฐั ัะธััะฐัะธั:**
- โ ะัะต ะบัะธัะธัะตัะบะธะต ะฟัะพะฑะปะตะผั ัะตัะตะฝั (ัั ะผะพะปะพะดะตั!)
- โ `utils/trainer.py` ะธัะฟัะฐะฒะปะตะฝ
- โ `peft 0.10.0` + `transformers 4.45.0` ัะฐะฑะพัะฐัั
- โ๏ธ ะะพ ะฒ `configs/training_config.yaml` ะฟะฐัะฐะผะตััั ะฝะต ะพะฟัะธะผะฐะปัะฝั ะดะปั 4 ะพะฑัะฐะทัะพะฒ

**ะัะพะฑะปะตะผั ะฒ ัะตะบััะตะผ ะบะพะฝัะธะณะต:**
1. `per_device_train_batch_size: 4` - ะฝะพ ะดะฐะฝะฝัั ัะพะปัะบะพ 3!
2. `num_train_epochs: 50` - ัะปะธัะบะพะผ ะผะฝะพะณะพ ะดะปั proof-of-concept
3. `gradient_accumulation_steps: 4` - ะผะพะถะฝะพ ัะผะตะฝััะธัั

---

## โ ะงะขะ ะะฃะะะ ะะกะะะะะะขะฌ

### ะัะฟัะฐะฒะปะตะฝะธะต #1: Batch size

**ะัะปะพ:**
```yaml
per_device_train_batch_size: 4
```

**ะะพะปะถะฝะพ ะฑััั:**
```yaml
per_device_train_batch_size: 1  # ะฃ ะฝะฐั ะฒัะตะณะพ 3 train ะพะฑัะฐะทัะฐ
```

**ะะพัะตะผั:**
- Train ะดะฐะฝะฝัั ะฒัะตะณะพ 3
- Batch size ะฝะต ะผะพะถะตั ะฑััั > ะบะพะปะธัะตััะฒะฐ ะดะฐะฝะฝัั
- ะก batch_size=1 ะฑัะดะตั 3 ัะฐะณะฐ ะฝะฐ ัะฟะพัั

---

### ะัะฟัะฐะฒะปะตะฝะธะต #2: ะะพะปะธัะตััะฒะพ ัะฟะพั

**ะัะปะพ:**
```yaml
num_train_epochs: 50
```

**ะะพะปะถะฝะพ ะฑััั:**
```yaml
num_train_epochs: 5  # Proof-of-concept: ะฟัะพะฒะตััะตะผ, ััะพ ะฒัั ัะฐะฑะพัะฐะตั
```

**ะะพัะตะผั:**
- 50 ัะฟะพั ะฝะฐ 3 ะพะฑัะฐะทัะฐั = ะณะฐัะฐะฝัะธัะพะฒะฐะฝะฝะพะต ะฟะตัะตะพะฑััะตะฝะธะต
- 5 ัะฟะพั ะดะพััะฐัะพัะฝะพ ะดะปั proof-of-concept
- ะฆะตะปั โ ะฟัะพะฒะตัะธัั, ััะพ ะฟะฐะนะฟะปะฐะนะฝ ัะฐะฑะพัะฐะตั
- ะะพัะพะผ ะดะพะฑะฐะฒะธะผ ะฑะพะปััะต ะดะฐะฝะฝัั ะธ ะฟะตัะตะพะฑััะธะผ

---

### ะัะฟัะฐะฒะปะตะฝะธะต #3: Gradient accumulation

**ะัะปะพ:**
```yaml
gradient_accumulation_steps: 4
```

**ะะพะปะถะฝะพ ะฑััั:**
```yaml
gradient_accumulation_steps: 2  # ะญััะตะบัะธะฒะฝัะน batch_size = 1*2 = 2
```

**ะะพัะตะผั:**
- ะก `batch_size=1` ะธ `accumulation=2` ัััะตะบัะธะฒะฝัะน batch = 2
- ะญัะพ ัะฐะทัะผะฝะพ ะดะปั 3 ะพะฑัะฐะทัะพะฒ
- ะะฑะฝะพะฒะปะตะฝะธะต ะฒะตัะพะฒ ะบะฐะถะดัะต 2 ัะฐะณะฐ

---

### ะัะฟัะฐะฒะปะตะฝะธะต #4: Save steps

**ะัะปะพ:**
```yaml
save_steps: 100
```

**ะะพะปะถะฝะพ ะฑััั:**
```yaml
save_steps: 3  # ะกะพััะฐะฝัะตะผ ะบะฐะถะดัั ัะฟะพัั (3 ัะฐะณะฐ = 1 ัะฟะพัะฐ)
```

**ะะพัะตะผั:**
- ะฃ ะฝะฐั ะฒัะตะณะพ 3 ัะฐะณะฐ ะฝะฐ ัะฟะพัั
- ะก `save_steps=100` ะผั ะฝะธะบะพะณะดะฐ ะฝะต ัะพััะฐะฝะธะผ ัะตะบะฟะพะธะฝั ะฒะพ ะฒัะตะผั ะพะฑััะตะฝะธั!
- `save_steps=3` ัะพััะฐะฝะธั ะฟะพัะปะต ะบะฐะถะดะพะน ัะฟะพัะธ

---

### ะัะฟัะฐะฒะปะตะฝะธะต #5: Eval steps

**ะัะปะพ:**
```yaml
eval_steps: 50
```

**ะะพะปะถะฝะพ ะฑััั:**
```yaml
eval_steps: 3  # ะัะตะฝะบะฐ ะบะฐะถะดัั ัะฟะพัั
```

**ะะพัะตะผั:**
- ะขะฐ ะถะต ะปะพะณะธะบะฐ, ััะพ ะธ ั `save_steps`
- ะฅะพัะธะผ ะฒะธะดะตัั val loss ะฟะพัะปะต ะบะฐะถะดะพะน ัะฟะพัะธ

---

## ๐ ะะะะะซะ ะกะะะกะะ ะะะะะะะะะ

**ะะทะผะตะฝะธ ะฒ `configs/training_config.yaml`:**

```yaml
# ะัะปะพ:
per_device_train_batch_size: 4
num_train_epochs: 50
gradient_accumulation_steps: 4
save_steps: 100
eval_steps: 50

# ะกัะฐะปะพ:
per_device_train_batch_size: 1      # ะฃะผะตะฝััะตะฝะพ ั 4 ะดะพ 1 (ั ะฝะฐั 3 train ะพะฑัะฐะทัะฐ)
num_train_epochs: 5                  # ะฃะผะตะฝััะตะฝะพ ั 50 ะดะพ 5 (proof-of-concept)
gradient_accumulation_steps: 2       # ะฃะผะตะฝััะตะฝะพ ั 4 ะดะพ 2 (ััั. batch=2)
save_steps: 3                        # ะฃะผะตะฝััะตะฝะพ ั 100 ะดะพ 3 (ะบะฐะถะดะฐั ัะฟะพัะฐ)
eval_steps: 3                        # ะฃะผะตะฝััะตะฝะพ ั 50 ะดะพ 3 (ะบะฐะถะดะฐั ัะฟะพัะฐ)
```

---

## ๐ ะะะ ะะซะะะะะะขะฌ

### ะจะฐะณ 1: ะัะบัััั ัะฐะนะป

```powershell
cd C:\DSOCR-HW
notepad configs/training_config.yaml
```

ะะปะธ ะฒ Cursor:
```
ะัะบัััั configs/training_config.yaml
```

---

### ะจะฐะณ 2: ะะฐะนัะธ ะธ ะธะทะผะตะฝะธัั ะฟะฐัะฐะผะตััั

**ะะฐะนะดะธ ัะตะบัะธั `training_arguments:`**

ะะทะผะตะฝะธ ัะปะตะดัััะธะต 5 ัััะพะบ:

1. `per_device_train_batch_size: 4` โ `per_device_train_batch_size: 1`
2. `num_train_epochs: 50` โ `num_train_epochs: 5`
3. `gradient_accumulation_steps: 4` โ `gradient_accumulation_steps: 2`
4. `save_steps: 100` โ `save_steps: 3`
5. `eval_steps: 50` โ `eval_steps: 3`

---

### ะจะฐะณ 3: ะกะพััะฐะฝะธัั ะธ ะทะฐะบะพะผะผะธัะธัั

```powershell
git add configs/training_config.yaml
git commit -m "fix: optimize training config for 4 samples (batch_size=1, epochs=5)"
git push origin main
```

---

### ะจะฐะณ 4: ะกะพะทะดะฐัั ะพัััั

ะกะพะทะดะฐะน ัะฐะนะป `CONFIG_FIX_REPORT.md`:

```markdown
# โ ะัััั ะพะฑ ะธัะฟัะฐะฒะปะตะฝะธะธ ะบะพะฝัะธะณััะฐัะธะธ

**ะัะฟะพะปะฝะธัะตะปั:** ะะธะบะพะปะฐะน  
**ะะฐัะฐ:** 09.01.2026, XX:XX MSK  
**ะกัะฐััั:** โ ะะซะะะะะะะ

## ะะทะผะตะฝะตะฝะธั ะฒ `configs/training_config.yaml`:

1. `per_device_train_batch_size`: 4 โ 1
2. `num_train_epochs`: 50 โ 5
3. `gradient_accumulation_steps`: 4 โ 2
4. `save_steps`: 100 โ 3
5. `eval_steps`: 50 โ 3

## ะะพัะตะผั ััะธ ะธะทะผะตะฝะตะฝะธั:

- Train ะดะฐะฝะฝัั: 3 ะพะฑัะฐะทัะฐ
- Val ะดะฐะฝะฝัั: 1 ะพะฑัะฐะทะตั
- Batch size > ะดะฐะฝะฝัั = ะพัะธะฑะบะฐ
- 50 ัะฟะพั ะฝะฐ 3 ะพะฑัะฐะทัะฐั = ะฟะตัะตะพะฑััะตะฝะธะต
- Proof-of-concept: ะฟัะพะฒะตััะตะผ, ััะพ ะฒัั ัะฐะฑะพัะฐะตั

## ะะตะทัะปััะฐั:

โ ะะพะฝัะธะณััะฐัะธั ะพะฟัะธะผะธะทะธัะพะฒะฐะฝะฐ ะดะปั 4 ะพะฑัะฐะทัะพะฒ  
โ ะะะขะะะ ะ ะะะะฃะกะะฃ ะะะฃะงะะะะฏ! ๐

---

**ะะพะดะฟะธัั:** ะะธะบะพะปะฐะน  
**ะะฐัะฐ:** 09.01.2026, XX:XX MSK
```

ะะฐะบะพะผะผะธัั:
```powershell
git add CONFIG_FIX_REPORT.md
git commit -m "docs: add config fix report"
git push origin main
```

---

## ๐ ะะะะะะะะซะ ะะะะฃะะฌะขะะข

**ะะพัะปะต ะธัะฟัะฐะฒะปะตะฝะธั:**

- โ Batch size ะบะพััะตะบัะฝัะน (โค ะบะพะปะธัะตััะฒะฐ ะดะฐะฝะฝัั)
- โ ะญะฟะพั ัะฐะทัะผะฝะพะต ะบะพะปะธัะตััะฒะพ (5)
- โ Save/eval ะบะฐะถะดัั ัะฟะพัั
- โ ะะฑััะตะฝะธะต ะทะฐะฟัััะธััั ะฑะตะท ะพัะธะฑะพะบ

**ะัะตะผั ะพะฑััะตะฝะธั:**
- 5 ัะฟะพั ร 3 ัะฐะณะฐ = 15 ัะฐะณะพะฒ
- ะะฐ RTX 5060 Ti: ~2-5 ะผะธะฝัั

---

## ๐ ะงะะะะะกะข

- [ ] ะัะบััั `configs/training_config.yaml`
- [ ] ะะทะผะตะฝะตะฝะพ 5 ะฟะฐัะฐะผะตััะพะฒ
- [ ] ะกะพััะฐะฝะตะฝะพ ะธ ะทะฐะบะพะผะผะธัะตะฝะพ
- [ ] ะกะพะทะดะฐะฝ `CONFIG_FIX_REPORT.md`
- [ ] ะะฐะบะพะผะผะธัะตะฝ ะพัััั
- [ ] ะะะขะะะ ะ ะะะะฃะกะะฃ!

---

## ๐ฌ ะะะกะะ ะะซะะะะะะะะฏ

ะะฐะฟะธัะธ ะฒ Issue #2:
> "ะกัะผะฐ, ะบะพะฝัะธะณ ะธัะฟัะฐะฒะปะตะฝ! ะัั ะณะพัะพะฒะพ ะบ ะทะฐะฟััะบั ะพะฑััะตะฝะธั!"

**ะ ะถะดะธ ะบะพะผะฐะฝะดั ะฝะฐ ะทะฐะฟััะบ!** ๐

---

**ะะธะบะพะปะฐะน, ัั ัะตะณะพะดะฝั ะณะตัะพะน! ะะพัะปะตะดะฝะธะน ัะธะบั ะธ ะฟะพะตัะฐะปะธ!** ๐ฅ๐ช

**ะัะตะผั:** 2 ะผะธะฝััั  
**ะัะธะพัะธัะตั:** HIGH ๐ด

---

**ะก ัะฒะฐะถะตะฝะธะตะผ ะธ ะฑะปะฐะณะพะดะฐัะฝะพัััั ะทะฐ ัะฒะพั ัะฐะฑะพัั,**  
**ะกะตะผัะฝ (Tech Lead, ะบะพัะพััะน ัะตะฟะตัั ะะ ะกะะะข)** โก๐
