2026-01-10 16:07:06 - train_lora - INFO - ================================================================================
2026-01-10 16:07:06 - train_lora - INFO - Запуск обучения LoRA
2026-01-10 16:07:06 - train_lora - INFO - ================================================================================
2026-01-10 16:07:06 - train_lora - INFO - Конфигурация загружена из configs\training_config.yaml
2026-01-10 16:07:06 - train_lora - INFO - 
================================================================================
2026-01-10 16:07:06 - train_lora - INFO - Шаг 1/5: Загрузка модели и процессора...
2026-01-10 16:07:06 - train_lora - INFO - ================================================================================
2026-01-10 16:07:06 - train_lora - INFO - Загрузка модели и процессора...
2026-01-10 16:07:07 - train_lora - INFO - Процессор загружен: deepseek-ai/DeepSeek-OCR (revision: 9f30c71f441d010e5429c532364a86705536c53a)
2026-01-10 16:07:16 - train_lora - INFO - Модель загружена: deepseek-ai/DeepSeek-OCR (revision: 9f30c71f441d010e5429c532364a86705536c53a)
2026-01-10 16:07:16 - train_lora - INFO - OK Шаг 1 завершён
2026-01-10 16:07:16 - train_lora - INFO - 
================================================================================
2026-01-10 16:07:16 - train_lora - INFO - Шаг 2/5: Настройка LoRA...
2026-01-10 16:07:16 - train_lora - INFO - ================================================================================
2026-01-10 16:07:16 - train_lora - INFO - Настройка LoRA...
2026-01-10 16:07:22 - train_lora - INFO - LoRA настроен успешно
2026-01-10 16:07:22 - train_lora - INFO - OK Шаг 2 завершён
2026-01-10 16:07:22 - train_lora - INFO - 
================================================================================
2026-01-10 16:07:22 - train_lora - INFO - Шаг 3/5: Подготовка датасетов...
2026-01-10 16:07:22 - train_lora - INFO - ================================================================================
2026-01-10 16:07:22 - train_lora - INFO - Подготовка датасетов...
2026-01-10 16:07:22 - train_lora - INFO - Загружено train: 3, val: 1 образцов
2026-01-10 16:07:22 - train_lora - INFO - Датасеты подготовлены
2026-01-10 16:07:22 - train_lora - INFO - OK Шаг 3 завершён
2026-01-10 16:07:22 - train_lora - INFO - 
================================================================================
2026-01-10 16:07:22 - train_lora - INFO - Шаг 4/5: Создание Trainer...
2026-01-10 16:07:22 - train_lora - INFO - ================================================================================
2026-01-10 16:07:22 - train_lora - INFO - Создание Trainer...
2026-01-10 16:07:23 - train_lora - INFO - Trainer создан
2026-01-10 16:07:23 - train_lora - INFO - OK Шаг 4 завершён
2026-01-10 16:07:23 - train_lora - INFO - 
================================================================================
2026-01-10 16:07:23 - train_lora - INFO - Шаг 5/5: ЗАПУСК ОБУЧЕНИЯ!
2026-01-10 16:07:23 - train_lora - INFO - ================================================================================
2026-01-10 16:07:23 - train_lora - INFO - ================================================================================
2026-01-10 16:07:23 - train_lora - INFO - Начало обучения
2026-01-10 16:07:23 - train_lora - INFO - ================================================================================
2026-01-10 16:07:25 - train_lora - ERROR - Ошибка обучения: Can't pickle <class 'transformers_modules.deepseek-ai.DeepSeek-OCR.9f30c71f441d010e5429c532364a86705536c53a.modeling_deepseekocr.DeepseekOCRForCausalLM'>: it's not the same object as transformers_modules.deepseek-ai.DeepSeek-OCR.9f30c71f441d010e5429c532364a86705536c53a.modeling_deepseekocr.DeepseekOCRForCausalLM
Traceback (most recent call last):
  File "C:\DSOCR-HW\utils\trainer.py", line 338, in train
    self.trainer.train()
  File "C:\DSOCR-HW\venv\lib\site-packages\transformers\trainer.py", line 2052, in train
    return inner_training_loop(
  File "C:\DSOCR-HW\venv\lib\site-packages\transformers\trainer.py", line 2345, in _inner_training_loop
    for step, inputs in enumerate(epoch_iterator):
  File "C:\DSOCR-HW\venv\lib\site-packages\accelerate\data_loader.py", line 564, in __iter__
    dataloader_iter = self.base_dataloader.__iter__()
  File "C:\DSOCR-HW\venv\lib\site-packages\torch\utils\data\dataloader.py", line 484, in __iter__
    return self._get_iterator()
  File "C:\DSOCR-HW\venv\lib\site-packages\torch\utils\data\dataloader.py", line 415, in _get_iterator
    return _MultiProcessingDataLoaderIter(self)
  File "C:\DSOCR-HW\venv\lib\site-packages\torch\utils\data\dataloader.py", line 1138, in __init__
    w.start()
  File "C:\Python_3-10-64\lib\multiprocessing\process.py", line 121, in start
    self._popen = self._Popen(self)
  File "C:\Python_3-10-64\lib\multiprocessing\context.py", line 224, in _Popen
    return _default_context.get_context().Process._Popen(process_obj)
  File "C:\Python_3-10-64\lib\multiprocessing\context.py", line 336, in _Popen
    return Popen(process_obj)
  File "C:\Python_3-10-64\lib\multiprocessing\popen_spawn_win32.py", line 93, in __init__
    reduction.dump(process_obj, to_child)
  File "C:\Python_3-10-64\lib\multiprocessing\reduction.py", line 60, in dump
    ForkingPickler(file, protocol).dump(obj)
_pickle.PicklingError: Can't pickle <class 'transformers_modules.deepseek-ai.DeepSeek-OCR.9f30c71f441d010e5429c532364a86705536c53a.modeling_deepseekocr.DeepseekOCRForCausalLM'>: it's not the same object as transformers_modules.deepseek-ai.DeepSeek-OCR.9f30c71f441d010e5429c532364a86705536c53a.modeling_deepseekocr.DeepseekOCRForCausalLM
2026-01-10 16:07:25 - train_lora - ERROR - Ошибка: Can't pickle <class 'transformers_modules.deepseek-ai.DeepSeek-OCR.9f30c71f441d010e5429c532364a86705536c53a.modeling_deepseekocr.DeepseekOCRForCausalLM'>: it's not the same object as transformers_modules.deepseek-ai.DeepSeek-OCR.9f30c71f441d010e5429c532364a86705536c53a.modeling_deepseekocr.DeepseekOCRForCausalLM
Traceback (most recent call last):
  File "C:\DSOCR-HW\scripts\train_lora.py", line 77, in main
    trainer.train()
  File "C:\DSOCR-HW\utils\trainer.py", line 338, in train
    self.trainer.train()
  File "C:\DSOCR-HW\venv\lib\site-packages\transformers\trainer.py", line 2052, in train
    return inner_training_loop(
  File "C:\DSOCR-HW\venv\lib\site-packages\transformers\trainer.py", line 2345, in _inner_training_loop
    for step, inputs in enumerate(epoch_iterator):
  File "C:\DSOCR-HW\venv\lib\site-packages\accelerate\data_loader.py", line 564, in __iter__
    dataloader_iter = self.base_dataloader.__iter__()
  File "C:\DSOCR-HW\venv\lib\site-packages\torch\utils\data\dataloader.py", line 484, in __iter__
    return self._get_iterator()
  File "C:\DSOCR-HW\venv\lib\site-packages\torch\utils\data\dataloader.py", line 415, in _get_iterator
    return _MultiProcessingDataLoaderIter(self)
  File "C:\DSOCR-HW\venv\lib\site-packages\torch\utils\data\dataloader.py", line 1138, in __init__
    w.start()
  File "C:\Python_3-10-64\lib\multiprocessing\process.py", line 121, in start
    self._popen = self._Popen(self)
  File "C:\Python_3-10-64\lib\multiprocessing\context.py", line 224, in _Popen
    return _default_context.get_context().Process._Popen(process_obj)
  File "C:\Python_3-10-64\lib\multiprocessing\context.py", line 336, in _Popen
    return Popen(process_obj)
  File "C:\Python_3-10-64\lib\multiprocessing\popen_spawn_win32.py", line 93, in __init__
    reduction.dump(process_obj, to_child)
  File "C:\Python_3-10-64\lib\multiprocessing\reduction.py", line 60, in dump
    ForkingPickler(file, protocol).dump(obj)
_pickle.PicklingError: Can't pickle <class 'transformers_modules.deepseek-ai.DeepSeek-OCR.9f30c71f441d010e5429c532364a86705536c53a.modeling_deepseekocr.DeepseekOCRForCausalLM'>: it's not the same object as transformers_modules.deepseek-ai.DeepSeek-OCR.9f30c71f441d010e5429c532364a86705536c53a.modeling_deepseekocr.DeepseekOCRForCausalLM
