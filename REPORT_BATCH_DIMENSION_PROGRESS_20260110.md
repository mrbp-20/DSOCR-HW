# üìä –û–¢–ß–Å–¢: –ü–†–û–ì–†–ï–°–° –° BATCH DIMENSION

**–î–∞—Ç–∞:** 2026-01-10, 19:52 MSK  
**–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å:** –ù–∏–∫–æ–ª–∞–π  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ü–†–û–ì–†–ï–°–°! –ù–æ–≤–∞—è –æ—à–∏–±–∫–∞ (–∑–Ω–∞—á–∏—Ç, batch dimension –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π)**

---

## ‚úÖ –î–û–°–¢–ò–ñ–ï–ù–ò–Ø

1. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω `.unsqueeze(0)` –∫ `image_tensor` –¥–ª—è batch dimension
2. ‚úÖ –ò–∑–º–µ–Ω—ë–Ω `images_spatial_crop` —Å `[None]` –Ω–∞ `[[1, 1]] * len(images_list)`
3. ‚úÖ **–ú–æ–¥–µ–ª—å –¥–æ—à–ª–∞ –¥–∞–ª—å—à–µ –≤ –æ–±—Ä–∞–±–æ—Ç–∫–µ!** (–Ω–æ–≤–∞—è –æ—à–∏–±–∫–∞)

---

## üîÑ –≠–í–û–õ–Æ–¶–ò–Ø –û–®–ò–ë–û–ö

**–û—à–∏–±–∫–∞ 1:** `permute(sparse_coo): number of dimensions...` (3D vs 4D)
- **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:** –î–æ–±–∞–≤–∏–ª `.unsqueeze(0)` –∫ `image_tensor`

**–û—à–∏–±–∫–∞ 2:** `'NoneType' object is not subscriptable` (crop_shape[0], crop_shape[1])
- **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:** –ò–∑–º–µ–Ω–∏–ª `images_spatial_crop` —Å `[None]` –Ω–∞ `[[1, 1]] * len(images_list)`

**–û—à–∏–±–∫–∞ 3:** `'NoneType' object is not subscriptable` (images_seq_mask[idx])
- **–°—Ç–∞—Ç—É—Å:** –¢–µ–∫—É—â–∞—è –æ—à–∏–±–∫–∞
- **–ó–Ω–∞—á–µ–Ω–∏–µ:** –ú–æ–¥–µ–ª—å –¥–æ—à–ª–∞ –µ—â—ë –¥–∞–ª—å—à–µ!
- **–ü—Ä–æ–±–ª–µ–º–∞:** `images_seq_mask` –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Å–ø–∏—Å–∫–æ–º/—Ç–µ–Ω–∑–æ—Ä–æ–º, –∞ –Ω–µ None

---

## üìä –¢–ï–ö–£–©–ï–ï –°–û–°–¢–û–Ø–ù–ò–ï

**–ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
- ‚úÖ Batch dimension –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π (4D —Ç–µ–Ω–∑–æ—Ä—ã)
- ‚úÖ `images_spatial_crop` –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç `[[1, 1], ...]`
- ‚úÖ –ú–æ–¥–µ–ª—å –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ

**–¢–µ–∫—É—â–∞—è –ø—Ä–æ–±–ª–µ–º–∞:**
- ‚ùå `images_seq_mask` –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å —Ñ–æ—Ä–º–∞—Ç —Å–ø–∏—Å–∫–∞/—Ç–µ–Ω–∑–æ—Ä–∞, –Ω–æ —Ñ–æ—Ä–º–∞—Ç –Ω–µ–∏–∑–≤–µ—Å—Ç–µ–Ω

**–í—ã–≤–æ–¥:** Batch dimension –∏ `images_spatial_crop` **–ü–†–ê–í–ò–õ–¨–ù–´–ï**! –û—Å—Ç–∞–ª–æ—Å—å –∏—Å–ø—Ä–∞–≤–∏—Ç—å —Ñ–æ—Ä–º–∞—Ç `images_seq_mask`.

---

## üí° –ù–£–ñ–ù–ê –ò–ù–§–û–†–ú–ê–¶–ò–Ø

–§–æ—Ä–º–∞—Ç `images_seq_mask` –Ω–µ–∏–∑–≤–µ—Å—Ç–µ–Ω. –ò–∑ –æ—à–∏–±–∫–∏ –≤–∏–¥–Ω–æ:
```python
images_seq_mask[idx].unsqueeze(-1).cuda()
```

–ó–Ω–∞—á–∏—Ç, —ç—Ç–æ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Å–ø–∏—Å–æ–∫ –∏–ª–∏ —Ç–µ–Ω–∑–æ—Ä, –≥–¥–µ –∫–∞–∂–¥—ã–π —ç–ª–µ–º–µ–Ω—Ç –º–æ–∂–Ω–æ –∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞—Ç—å –∏ –¥–µ–ª–∞—Ç—å `unsqueeze(-1)`.

**–ù—É–∂–Ω–∞ –ø–æ–º–æ—â—å –°–µ–º—ë–Ω–∞** –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ñ–æ—Ä–º–∞—Ç–∞ `images_seq_mask`.

---

**–í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã:** ~5 –º–∏–Ω—É—Ç  
**–ò—Ç–æ–≥:** ‚úÖ **BATCH DIMENSION –ò images_spatial_crop –ü–†–ê–í–ò–õ–¨–ù–´–ï! –û—Å—Ç–∞–ª–æ—Å—å images_seq_mask!**
