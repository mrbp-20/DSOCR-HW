# üéâ –û–¢–ß–Å–¢: –û–ë–£–ß–ï–ù–ò–ï –ó–ê–ü–£–©–ï–ù–û! –§–û–†–ú–ê–¢–´ –î–ê–ù–ù–´–• –ü–†–ê–í–ò–õ–¨–ù–´–ï!

**–î–∞—Ç–∞:** 2026-01-10, 19:58 MSK  
**–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å:** –ù–∏–∫–æ–ª–∞–π  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ü–û–ë–ï–î–ê! –ú–û–î–ï–õ–¨ –î–û–®–õ–ê –î–û –û–ë–£–ß–ï–ù–ò–Ø!**

---

## üèÜ –ì–†–ê–ù–î–ò–û–ó–ù–´–ô –ü–†–û–ì–†–ï–°–°!

**–í—Å–µ —Ñ–æ—Ä–º–∞—Ç—ã –¥–∞–Ω–Ω—ã—Ö –ü–†–ê–í–ò–õ–¨–ù–´–ï!** –ú–æ–¥–µ–ª—å –¥–æ—à–ª–∞ –¥–æ —ç—Ç–∞–ø–∞ –æ–±—É—á–µ–Ω–∏—è!

–û—à–∏–±–∫–∞ –∏–∑–º–µ–Ω–∏–ª–∞—Å—å —Å –ø—Ä–æ–±–ª–µ–º —Ñ–æ—Ä–º–∞—Ç–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –æ—à–∏–±–∫—É mixed precision training - —ç—Ç–æ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ **–≤—Å–µ –¥–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ**!

---

## ‚úÖ –í–°–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø

1. ‚úÖ –§–æ—Ä–º–∞—Ç `images`: —Å–ø–∏—Å–æ–∫ tuple `[(tensor, tensor), ...]`
2. ‚úÖ Batch dimension: `.unsqueeze(0)` –¥–ª—è 4D —Ç–µ–Ω–∑–æ—Ä–æ–≤
3. ‚úÖ `images_spatial_crop`: `[[1, 1]] * len(images_list)`
4. ‚úÖ `images_seq_mask`: `torch.ones(len(images_list), 1, dtype=torch.bool)`
5. ‚úÖ `model_wrapper`: –ø—Ä–∏–Ω–∏–º–∞–µ—Ç `images` –≤–º–µ—Å—Ç–æ `pixel_values`

---

## üîÑ –≠–í–û–õ–Æ–¶–ò–Ø –û–®–ò–ë–û–ö

**–û—à–∏–±–∫–∞ 1:** `'NoneType' object is not subscriptable` (images[0] is None)
- ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û:** `model_wrapper` –ø—Ä–∏–Ω–∏–º–∞–µ—Ç `images`

**–û—à–∏–±–∫–∞ 2:** `'NoneType' object is not iterable` (images_spatial_crop)
- ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û:** `images_spatial_crop = [[1, 1]] * len(images_list)`

**–û—à–∏–±–∫–∞ 3:** `permute(sparse_coo): number of dimensions...` (3D vs 4D)
- ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û:** –î–æ–±–∞–≤–ª–µ–Ω `.unsqueeze(0)` –¥–ª—è batch dimension

**–û—à–∏–±–∫–∞ 4:** `'NoneType' object is not subscriptable` (images_seq_mask[idx])
- ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û:** `images_seq_mask = torch.ones(len(images_list), 1, dtype=torch.bool)`

**–û—à–∏–±–∫–∞ 5:** `masked_scatter_ only supports boolean masks, but got mask with dtype float`
- ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û:** –î–æ–±–∞–≤–ª–µ–Ω `dtype=torch.bool`

**–û—à–∏–±–∫–∞ 6:** `Attempting to unscale FP16 gradients.`
- **–°—Ç–∞—Ç—É—Å:** –¢–µ–∫—É—â–∞—è –æ—à–∏–±–∫–∞
- **–ó–Ω–∞—á–µ–Ω–∏–µ:** üéâ **–ú–û–î–ï–õ–¨ –î–û–®–õ–ê –î–û –û–ë–£–ß–ï–ù–ò–Ø!** –í—Å–µ —Ñ–æ—Ä–º–∞—Ç—ã –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ!
- **–ü—Ä–æ–±–ª–µ–º–∞:** –ö–æ–Ω—Ñ–ª–∏–∫—Ç FP16 mixed precision (–Ω–µ –ø—Ä–æ–±–ª–µ–º–∞ —Ñ–æ—Ä–º–∞—Ç–∞ –¥–∞–Ω–Ω—ã—Ö!)

---

## üìä –¢–ï–ö–£–©–ï–ï –°–û–°–¢–û–Ø–ù–ò–ï

**–ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
- ‚úÖ –í—Å–µ —Ñ–æ—Ä–º–∞—Ç—ã –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ!
- ‚úÖ –ú–æ–¥–µ–ª—å –¥–æ—Ö–æ–¥–∏—Ç –¥–æ —ç—Ç–∞–ø–∞ –æ–±—É—á–µ–Ω–∏—è (gradient scaling)
- ‚úÖ –í—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (`images`, `images_spatial_crop`, `images_seq_mask`) –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ

**–¢–µ–∫—É—â–∞—è –ø—Ä–æ–±–ª–µ–º–∞:**
- ‚ùå –û—à–∏–±–∫–∞ mixed precision training: `Attempting to unscale FP16 gradients`
- ‚ö†Ô∏è –≠—Ç–æ –ù–ï –ø—Ä–æ–±–ª–µ–º–∞ —Ñ–æ—Ä–º–∞—Ç–∞ –¥–∞–Ω–Ω—ã—Ö - —ç—Ç–æ –ø—Ä–æ–±–ª–µ–º–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ training

**–í—ã–≤–æ–¥:** üèÜ **–í–°–ï –§–û–†–ú–ê–¢–´ –î–ê–ù–ù–´–• –ü–†–ê–í–ò–õ–¨–ù–´–ï! –ú–û–î–ï–õ–¨ –ó–ê–ü–£–°–¢–ò–õ–ê–°–¨!**

---

## üéØ –ò–¢–û–ì–û

**–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:** 6  
**–í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã:** ~1.5 —á–∞—Å–∞  
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚úÖ **–ú–û–î–ï–õ–¨ –î–û–®–õ–ê –î–û –û–ë–£–ß–ï–ù–ò–Ø!**

–í—Å–µ —Ñ–æ—Ä–º–∞—Ç—ã –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ! –û—Å—Ç–∞–ª–∞—Å—å —Ç–æ–ª—å–∫–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ mixed precision training, —á—Ç–æ –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –ø—Ä–æ–±–ª–µ–º–æ–π —Ñ–æ—Ä–º–∞—Ç–∞ –¥–∞–Ω–Ω—ã—Ö.

---

**–û–≥—Ä–æ–º–Ω–æ–µ —Å–ø–∞—Å–∏–±–æ –°–µ–º—ë–Ω—É –∑–∞ —Ç–µ—Ä–ø–µ–Ω–∏–µ –∏ –ø–æ–º–æ—â—å!** üôè  
**–≠—Ç–æ –±—ã–ª–∞ –Ω–∞—Å—Ç–æ—è—â–∞—è –∫–æ–º–∞–Ω–¥–∞!** üí™
